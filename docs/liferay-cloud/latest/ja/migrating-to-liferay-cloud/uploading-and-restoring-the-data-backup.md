# ステージ3：データバックアップのアップロードとリストア

Liferay DXPデータベースとドキュメントライブラリが互換性のある形式になったので、次の段階では、それらをまとめて1つのバックアップとしてLiferay Cloudにアップロードし、選択した環境にリストアすることになります。

## バックアップのアップロード

まず、選択した環境の `backup` サービスにデータをアップロードする必要があります。 これにより、新しいバックアップが作成され、その後復元することができます。

```{warning}
バックアップのアップロードは、ファイルサイズやインターネット接続速度によって、数分から数時間かかることがあります。 アップロードの進行中は、`backup` サービスは他のバックアップを作成、復元、削除することができません。 アップロードが終了するまで、処理が滞らないように、アップロード中のウィンドウを閉じたり、端末をスリープ状態にしたりしないでください*。
```

バックアップのページでバックアップをアップロードします。

1. Liferay Cloudコンソールで、選択した環境に移動し、左側のメニューから **Backups** をクリックしてください。

    ![Backups画面に移動し、データをアップロードします。](./uploading-and-restoring-the-data-backup/images/01.png)

1. バックアップ]ページで、画面上部の **Upload Backup...をクリックします。画面上部の** をクリックします。

1. 先に作成したデータベースダンプとドキュメントライブラリアーカイブ [を、それぞれのボタンをクリックして追加します](./creating-data-backup-files.md) 。

    ![ボタンをクリックすると、データベースとドキュメントライブラリが新規バックアップとしてアップロードされます。](./uploading-and-restoring-the-data-backup/images/02.png)

    ```{note}
    データベースダンプとドキュメントライブラリのアップロードは、合計で**2 TB**を超えないようにしてください。 大きなファイルをアップロードする場合は、 [DXPクラウドサポートにお問い合わせください](https://help.liferay.com/hc/ja/articles/360030208451-DXP-Cloud-Support-Overview) 。
    ```

1. **Initiate Upload** をクリックし、アップロードが完了するのを待ちます。

アップロードが完了すると、「バックアップ」ページのリストの一番上に、お客様のデータが入った新しいバックアップが用意されます。

## バックアップを復元する

Backupsページでアップロードして作成したバックアップを復元します。

1. **Restore to...をクリックします。** をクリックすると、正しいバックアップが表示されます。

    ![Restore to アクションをクリックすると、正しいバックアップのリストアページに移動します。](./uploading-and-restoring-the-data-backup/images/03.png)

1. バックアップの復元先として適切な環境をドロップダウンメニューから選択します。

    ![バックアップの復元先として正しい環境を選択します。](./uploading-and-restoring-the-data-backup/images/04.png)

    ```{warning}
     ターゲット環境を正しく選択してください。 バックアップを復元すると、対象環境のデータベースとLiferayのデータストレージはバックアップのデータで上書きされ、上書きは元に戻せなくなります。
    ```

1. **Restore to Environment** をクリックし、バックアップのリストアが完了するのを待ちます。

    ```{warning}
    バックアップのリストア中にターゲット環境が利用できなくなる。
    ```

バックアップのリストアが完了すると、ターゲット環境には、アップロードしたデータベースとドキュメントライブラリの同じデータが存在します。

```{tip}
対象環境のトップバーにある *Visit Site* をクリックすると、Liferay Cloud 上の Liferay DXP インスタンスの状態を確認することができます。
```

## 次のステップ

これで、DXPクラウド上でLiferayのインスタンスが立ち上がり、データが表示されるようになりました。 次に、 [Liferay DXPの設定やカスタマイズ](./migrating-dxp-configurations-and-customizations.md) をクラウド環境に移行します。
