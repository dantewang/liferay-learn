# 보안 비밀로 보안 환경 변수 관리

비밀을 사용하면 Liferay Cloud 내의 모든 환경에 대한 변수를 안전하게 저장할 수 있습니다. Liferay Cloud 프로젝트를 볼 수 있는 권한이 있는 모든 사용자는 [환경 변수](../../reference/defining-environment-variables.md)를 볼 수 있지만 비밀은 해당 역할에 볼 수 있는 권한이 부여된 경우에만 볼 수 있습니다.

## 비밀이란 무엇입니까?

암호는 해당 값을 보호하기 위한 추가 보안 조치가 있는 환경 변수입니다. 민감한 정보나 개인 정보(예: 자격 증명)를 정의하는 모든 환경 변수는 비밀로 저장해야 합니다. 비밀은 환경의 여러 서비스에 대한 보안 변수로 정의될 수 있습니다.

비밀을 볼 수 있는 권한이 있는 사용자는 모든 서비스에 대한 **환경 변수** 탭에서 비밀을 볼 수 있습니다. 다른 환경 변수와 동일한 페이지에 표시되며 자체 섹션에 있습니다.

![환경 변수 페이지에는 일반 환경 변수와 비밀이 모두 나열됩니다.](./managing-secure-environment-variables-with-secrets/images/01.png)

기본적으로 비밀은 **관리자** 역할을 가진 사용자만 볼 수 있습니다. 그러나 다른 역할을 가진 사용자도 볼 수 있도록 비밀을 구성할 수 있습니다.

비밀은 암호화되어 저장되며 일반 환경 변수보다 Liferay Cloud의 백엔드에 추가 보안이 있습니다. UI를 통해 비밀을 보면 저장된 값이 표시되기 전에 암호가 해독됩니다.

## 새 비밀 추가

새로운 비밀은 Liferay Cloud의 **설정** 화면을 통해 추가됩니다. **관리자** 역할을 가진 사용자만 새 암호를 추가할 수 있습니다.

```{warning}
서비스에 새 암호를 추가하면 서비스가 다시 시작되어 값이 적용될 수 있습니다.
```

새 암호를 추가하려면 다음 단계를 따르십시오.

1. Liferay 클라우드 콘솔에 로그인합니다.

1. 모든 환경에 대한 **설정** 화면으로 이동합니다.

    ![비밀에 액세스하려면 설정 화면으로 이동하십시오.](./managing-secure-environment-variables-with-secrets/images/02.png)

1. 페이지의 **비밀** 섹션에서 **새 비밀 만들기를 클릭합니다.**

    ![환경의 설정 화면에서 새 비밀을 만듭니다.](./managing-secure-environment-variables-with-secrets/images/03.png)

1. 이름과 설명을 입력합니다.

    ![새 암호의 이름과 설명을 입력합니다.](./managing-secure-environment-variables-with-secrets/images/04.png)

1. 안전하게 저장할 암호 값을 입력합니다. 이 값은 저장되기 전에 암호화된다는 점을 제외하면 환경 변수 값과 동일하게 작동합니다.

    ![배후에서 암호화할 암호 값을 입력합니다.](./managing-secure-environment-variables-with-secrets/images/05.png)

1. 해당되는 경우 **기여자** 또는 **게스트** 역할이 비밀을 볼 수 있도록 허용할지 여부를 선택합니다. **관리자** 역할을 가진 사용자는 항상 비밀을 볼 수 있습니다.

    ![관리자 역할 외에 보기 권한을 부여할 역할을 선택합니다.](./managing-secure-environment-variables-with-secrets/images/06.png)

1. 새 비밀 환경 변수를 추가할 서비스를 선택합니다. 선택한 각 서비스에 대해 환경 변수에 사용되는 키를 입력합니다(여러 서비스가 동일한 키로 암호를 사용할 수 있음).

    ![새 암호를 추가할 서비스를 선택합니다.](./managing-secure-environment-variables-with-secrets/images/07.png)

1. 이전 단계에서 서비스를 선택한 경우 아래에 나타나는 상자를 선택하여 영향을 받는 서비스에 이 암호를 추가하는 효과를 수락함을 나타냅니다. 버튼을 활성화하여 암호를 생성하려면 이 확인란을 선택해야 합니다.

    ![비밀 생성을 계속하려면 나타나는 상자를 선택하십시오.](./managing-secure-environment-variables-with-secrets/images/08.png)

1. **비밀 만들기를 클릭합니다.**

선택한 서비스는 환경 변수로 적용된 새 암호로 다시 시작됩니다.

## 기존 암호 보기 및 수정

기존 비밀을 보거나 수정하려면 환경에 대한 **설정** 페이지로 이동합니다. 그런 다음 **비밀** 섹션 내에서 나열된 비밀에 대한 작업 메뉴를 클릭합니다. 비밀 보기, 편집 또는 삭제 옵션이 표시됩니다.

![설정 페이지에서 기존 암호를 보거나 편집하거나 삭제합니다.](./managing-secure-environment-variables-with-secrets/images/09.png)

```{note}
사용자가 비밀을 볼 수 있는 권한이 있더라도 '관리자' 역할을 가진 사용자만 기존 비밀을 편집하거나 삭제할 수 있습니다. 'Admin' 역할이 없는 사용자가 비밀에 대한 작업 메뉴를 클릭하면 비밀을 볼 수 있는 옵션만 표시됩니다.
```

다음은 보기 권한이 있는 사용자가 비밀에 대한 **보기** 옵션을 클릭할 때 표시되는 페이지입니다.

![기존 비밀에 대한 보기 페이지입니다.](./managing-secure-environment-variables-with-secrets/images/10.png)

## 환경 변수에서 비밀 참조

**비밀 변수** 은 해당 값에 대해 비밀을 안전하게 참조하는 환경 변수입니다. 일반 환경 변수와 마찬가지로 비밀 변수는 서비스 `LCP.json` 파일 또는 환경 변수 페이지를 통해 정의할 수 있습니다. 비밀 변수가 비밀의 키를 참조할 수 있도록 비밀은 이미 [이전에](#adding-a-new-secret) 추가되어야 합니다.

비밀을 참조하려면:

1. 선택한 서비스의 환경 변수 페이지로 이동합니다.

1. **비밀 변수** 섹션까지 아래로 스크롤합니다.

    ![환경 변수 페이지의 비밀 변수 섹션을 사용하여 비밀을 추가할 수 있습니다.](./managing-secure-environment-variables-with-secrets/images/11.png)

1. **변수 추가** 을 클릭합니다.

1. 새 비밀 변수의 이름(**Key** 아래)을 선택하고 참조할 비밀을 선택합니다.

    ![UI를 통해 비밀 변수를 추가하여 특정 비밀을 참조하십시오.](./managing-secure-environment-variables-with-secrets/images/12.png)

새 환경 변수는 이제 해당 값에 대해 선택한 암호를 참조합니다.

### LCP.json을 통해 비밀 변수 추가

서비스의 `LCP.json` 파일에 추가된 환경 변수의 비밀을 참조할 수도 있습니다. 키 앞에 `@` 문자를 추가하여 변수 값에서 비밀 키를 참조합니다.

```json
{
    "env": {
        "VARIABLE_NAME": "@secret-key"
    }
}
```

파일을 서비스에 배포하면 환경 변수 페이지에 다른 변수와 함께 비밀 변수가 나타납니다.

## 관련 주제

* [LCP.json을 통한 구성](../../reference/configuration-via-lcp-json.md)
* [환경 변수 정의](../../reference/defining-environment-variables.md)