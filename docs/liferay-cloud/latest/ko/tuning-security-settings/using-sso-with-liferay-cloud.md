# Liferay Cloud에서 SSO 사용

고객은 SAML 2.0을 준수하는 싱글 사인온 ID 공급업체를 사용하여 Liferay 클라우드 플랫폼에서 사용자를 인증할 수 있습니다. 이 통합을 활성화하는 절차는 다음과 같습니다.

SAML을 사용하여 SSO를 사용하려면 클라이언트, SP(서비스 공급자), IdP(신원 공급자)의 세 가지 에이전트가 필요합니다. 클라이언트가 서비스 제공업체에 연결을 시도하면 서비스 제공업체는 클라이언트를 ID 제공업체로 리디렉션합니다. 신원 공급자가 클라이언트를 인증한 후, 신원 공급자는 서비스 공급자에게 클라이언트의 자격 증명에 대한 액세스 권한을 부여합니다.

이 시나리오에서 Liferay Cloud는 서비스 제공자 역할을 하고, Liferay Cloud에 로그인하려는 고객은 클라이언트이며, ID 제공자는 고객이 관리하는 엔터프라이즈 디렉토리 솔루션입니다.

## Liferay 클라우드 프로젝트에 SSO 사용 설정하기

1. [IdP에 올바른 사용자 프로필 데이터 매핑이 있는지 확인](#configure-the-correct-user-profile-data-mapping-with-your-identity-provider)
1. [Liferay 클라우드 팀에 IdP 메타데이터 제공](#provide-identity-provider-metadata-to-the-liferay-cloud-team)
1. [라이프레이 클라우드 팀이 제공된 IdP 데이터를 가져와 서비스 공급자(SP) 메타데이터 제공](#liferay-cloud-team-imports-provided-idp-data-and-provides-service-provider-metadata)
1. [Liferay 클라우드 팀에서 제공한 SP 메타데이터 가져오기](#import-sp-metadata-provided-by-the-liferay-cloud-team)

### ID 공급업체와 함께 올바른 사용자 프로필 데이터 매핑을 구성하세요.

고객이 SSO를 통해 로그인을 시도하면 Liferay Cloud는 IdP 시스템에 요청을 전송하고 자체 사용자 프로필 데이터와 응답을 일치시키려고 시도합니다. 응답의 사용자 프로필 데이터가 Liferay Cloud가 예상하는 것과 일치하는 필드에 매핑되도록 IdP를 구성해야 합니다.

이 필드는 필수 입력 사항입니다:

* **이메일** : 사용자의 이메일 주소
* **firstName** : 사용자의 이름
* **성** : 사용자의 성

### Liferay 클라우드 팀에 ID 공급자 메타데이터 제공

SSO를 활성화하려면 이러한 세부 정보를 포함한 IdP 시스템의 메타데이터를 Liferay 클라우드 팀에 제공해야 합니다:

| 분야                          | 묘사                                                                                                                                   |
|:--------------------------- |:------------------------------------------------------------------------------------------------------------------------------------ |
| IdP 발급자                     | ID 발급자의 이름(일반적으로 `EntityDescriptor` 메타데이터의 `EntityID` 속성)입니다.                                                                        |
| IdP 싱글 사인온 URL              | SAML 인증 요청을 수신하는 요청 엔드포인트(예: `<http://adfs.customer.com/saml/sso)>`)                                                           |
| IdP 서명 인증서                  | SAML 메시지 및 어설션 서명에 대한 IdP의 공개 키 인증서                                                                                                  |
| IdP 싱글 사인온 HTTP 메서드(요청 바인딩) | 고객의 ID 공급자가 인증 요청을 수신하기 위해 지원하는 HTTP 메서드입니다. 유효한 답변은 `POST` (기본값) 및 `GET`뿐입니다.                                                       |
| 서명 요청                       | 고객의 ID 공급자에게 전송되는 SAML 요청에 서명을 받아야 하는 경우 `TRUE` 로 설정하고, 그렇지 않은 경우 `FALSE`로 설정합니다.                                                    |
| RSA(요청 서명 알고리즘)             | `서명 요청` 이 `TRUE`로 설정된 경우 요청을 서명하는 데 사용되는 알고리즘을 입력합니다. 현재로서는 SHA-1(권장하지 않음) 및 SHA-256을 지원합니다. 요청 서명을 사용하지 않도록 설정한 경우 이 구성은 필요하지 않습니다. |

#### ADFS 관련 정보

Microsoft ADFS를 사용하는 클라이언트는 이러한 설정에 주의해야 합니다(SAML을 사용하여 SSO를 설정하는 데 필요함):

| 분야             | 묘사                                                                        |
|:-------------- |:------------------------------------------------------------------------- |
| IdP 발급자 URI    | 일반 탭의 **페더레이션 서비스 식별자** 에 사이트하며 기본값은 `http://domain/adfs/services/trust`입니다. |
| IdP 싱글 사인온 URL | 기본 설정은 `/adfs/ls`입니다. 예: `http://adfs.example.com/adfs/ls/`               |
| IdP 서명 인증서     | DER로 인코딩된 바이너리 X.509 인증서 파일                                               |

IdP 메타데이터가 생성되면 [라이프레이 클라우드 팀에 티켓을 개설하세요](https://help.liferay.com/hc/) . IdP 메타데이터는 XML 파일 또는 URL 엔드포인트로 전송할 수 있습니다(예: `https://[hostname]:[port]/c/saml/metadata`).

### 라이프레이 클라우드 팀이 제공된 IdP 데이터를 가져와 서비스 제공업체 메타데이터 제공

그런 다음 Liferay 클라우드 팀은 클라이언트에 다음 SP 메타데이터 값을 제공합니다:

| 분야                   | 묘사                                                                         |
|:-------------------- |:-------------------------------------------------------------------------- |
| 어설션 소비자 서비스(ACS) URL | Liferay Cloud에서 수신한 SAML 응답입니다. 항상 <https://auth.liferay.cloud>의 주소 서버입니다. |
| 대상 URL               | 고객의 ID 공급자에 액세스하는 데 사용되는 URL Liferay Cloud                                 |

### Liferay 클라우드 팀에서 제공한 SP 메타데이터 가져오기

SP 메타데이터를 받으면 해당 SP 메타데이터 값을 IdP에 입력합니다.

## SSO 사용

SSO를 사용하도록 설정하면 적절한 ID 공급자가 있는 사용자는 이를 사용하여 인증할 수 있습니다.

```{warning}
사용자가 처음으로 SSO로 인증하면 사용자 계정이 영구적으로 변경되며, 그 이후부터는 SSO를 사용하여 인증해야 합니다.
```

SSO를 사용하여 Liferay Cloud에 로그인합니다,

1. <https://console.liferay.cloud/login>으로 이동합니다.
1. **를 클릭하고 SSO를 통해 로그인** .

   ![로그인 페이지에서 SSO를 통한 로그인 버튼을 사용합니다.](./using-sso-with-liferay-cloud/images/01.png)

1. **조직 ID** 필드에 **회사명** 을 입력합니다.
1. **계속** 을 클릭합니다.

    ```{note}
    조직의 SSO를 사용하여 이미 인증한 경우에는 나머지 단계가 필요하지 않을 수 있습니다.
    ```

1. **이메일 주소** 필드에 **이메일 주소** 를 입력합니다. 이 이메일 주소는 회사의 데이터베이스 또는 디렉토리 서비스(예: LDAP 또는 ADFS)에 저장된 이메일 주소와 동일해야 합니다.
1. **비밀번호** 필드에 **비밀번호** 를 입력합니다. 이 비밀번호는 회사의 데이터베이스 또는 디렉토리 서비스에 저장된 이메일 주소와 동일한 비밀번호여야 합니다.
1. **를 클릭하고 로그인** .

로그인하면 모든 프로젝트와 환경을 볼 수 있습니다.

![모든 프로젝트와 환경이 표시됩니다.](./using-sso-with-liferay-cloud/images/02.png)
