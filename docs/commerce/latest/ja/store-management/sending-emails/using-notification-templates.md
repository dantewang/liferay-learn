# 通知テンプレートの使用

通知は、ユーザーに送信される自動メールです。 電子メール通知を送信するには、最初に **通知テンプレート** を作成します。 通知テンプレートは、メール通知の通知送信者、トリガー、およびコンテンツを定義します。 利用可能な通知テンプレートの完全なリストについては、 [Store Emails](./store-emails.md#notification-templates) 記事を参照してください。

```{note}
Liferay Commerceの通知機能を使用するには、最初にLiferay Digital Experience Platform（DXP）のメール設定を構成します。 詳しくは、 [メールの構成](https://learn.liferay.com/dxp/latest/ja/installation-and-upgrades/setting-up-liferay/configuring-mail.html) をご覧ください。
```

## 通知を作成する

次の手順に従って、受信した注文の通知を作成します。

1. ［**コントロールパネル**］ → ［**コマース**］ → ［**チャネル**］ に移動します。

    ![Commerce 2.1チャネル](./using-notification-templates/images/03.png)

1. 目的のチャネルをクリックします。
1. ［**通知**］ タブをクリックします。
1. ［**通知テンプレート**］ サブタブをクリックします。
1. 追加（![Add icon](../../images/icon-add.png)）ボタンをクリックして、新しい通知テンプレートを作成します。
1. 次のように入力します：
    * **名前** ：新規注文
    * **説明** ：新規注文テンプレート
    * **タイプ** ： 注文済み
    * **有効** ：トグルを ［**はい**］ に切り替えます。
    * **送信者メールアドレス** ：ストアのメールアドレス（例： **orders@yourstore.com**）
    * **送信者名** ：ストアまたは顧客サービス担当者の名前
    * **件名** ：メールの件名（例： **ご注文を受け取りました**）
    * **本文** ：メッセージを入力します。 `[%ORDER_CREATOR%]`や`[%ORDER_ID%]`などの変数を使用して、それぞれ顧客の名前と注文IDを表すことができます。 詳細は、[通知テンプレート変数リファレンスガイド](./notification-template-variables-reference-guide.md)を参照してください。

    ![2.1での通知テンプレートの追加](./using-notification-templates/images/02.png)

1. ［**保存**］ をクリックします。

新しい通知テンプレートが保存され、ストアは注文を受信すると、購入者に自動メールを送信します。

![通知キューですべての送信メールを確認してください。](./using-notification-templates/images/05.png)

## 例：プレースホルダー値の使用

メール通知テンプレートを作成する場合、変数のコンマ区切りリストを、メールコンテンツの **メール設定** および **本文** フィールドのキー値の代わりとして使用できます。 キーの値には、顧客の名前、注文ID、配送先と請求先の住所、注文のアイテムのリストが含まれます。

［**メール設定**］ および ［**メールの本文**］ セクションでプレースホルダー変数を使用できます。 この例では、注文の受領を確認するメールテンプレート通知を作成します。

### メール設定

受信者、送信者アドレス、送信者名を定義するには、次のように入力します。

* **送り先** : `[%ORDER_CREATOR%]`
* **送信者メールアドレス** ： orders@sahara.com
* **送信者名** : `[%ACCOUNT_ROLE_ORDER_MANAGER%]`

![メールでのプレースホルダー値の使用。](./using-notification-templates/images/06.png)

上記のように、複数の宛先に通知する場合は、 **送り先** の欄に入力することで、カンマ区切りのリストを作成することが可能です。 `[%ORDER_CREATOR%]`,`[%ACCOUNT_ROLE_ADMINISTRATOR%]`. これにより、注文者とアカウント管理者にメールが送信されます。

### メールの本文

通知の内容を定義するには、次のように入力します。

* **件名** ：受注済み
* **本文** ：

  ```
  `[%ORDER_CREATOR%]`様 
  ご注文`[%ORDER_ID%]`を承りました。
  ありがとうございます。`[%ACCOUNT_ROLE_ORDER_MANAGER%]`
  ```

## Commerce 2.0以前

Commerce 2.0以前でメール通知を作成するには：

1. ［**サイト管理**］ → ［**コマース**］ → ［**設定**］ に移動します。

    ![Commerce 2.0サイト設定](./using-notification-templates/images/04.png)

1. ［**通知**］ タブをクリックします。
1. ［**通知テンプレート**］ サブタブをクリックします。
1. 追加（![Add icon](../../images/icon-add.png)）ボタンをクリックして、新しい通知テンプレートを作成します。
1. 次のように入力します：
    * **名前** ：新規注文
    * **説明** ：新規注文テンプレート
    * **アカウントグループ** ：（空白のままにするか、 **オプションの** アカウントグループを指定します）
    * **送信者メールアドレス** ：ストアのメールアドレス（例： **orders@yourstore.com**）
    * **送信者名** ：ストアまたは顧客サービス担当者の名前
    * **タイプ** ： 注文済み
    * **有効** ：トグルを ［**はい**］ に切り替えます
    * **件名** ：メールの件名（例： **ご注文を受け取りました**）
    * **本文** ：`[%ORDER_CREATOR%]`や`[%ORDER_ID%]`などの変数を使用して、それぞれ顧客の名前と注文IDを表すことができます。 詳細は、[通知テンプレート変数リファレンスガイド](./notification-template-variables-reference-guide.md)を参照してください。

    ![通知テンプレートの追加](./using-notification-templates/images/01.png)

1. ［**Save**］ をクリックします。

新しい通知テンプレートが保存され、ストアが注文を受け取ると、ストアから購入者に自動メールが送信されます。 テンプレートが作成されると、注文が行われるたびに新しい通知が通知キューに追加されます。 注文が行われたときは、 ［**通知キュー**］ サブタブを確認してください。 デフォルトでは、Liferay Commerceは15分ごとにキューをチェックして、未送信の通知を送信します。 間隔を変更する方法については、[コマース通知キューの構成](./configuring-the-commerce-notification-queue.md)参照してください。

## 追加情報

* [通知テンプレート変数リファレンスガイド](./notification-template-variables-reference-guide.md)
* [コマース通知キューの設定](./configuring-the-commerce-notification-queue.md)
