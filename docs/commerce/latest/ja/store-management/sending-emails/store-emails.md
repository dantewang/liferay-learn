# メールを保存

Liferay Commerceは、ストアの様々なイベントトリガーに対してメール通知を送信するように設定することができます。 テンプレートはカスタマイズ可能で、メールの内容を定義します。 OOTBワイルドカードを使用したり、送信先のメールアドレスを指定することで、1つのイベントを異なるターゲットにメールを送信するよう設定することができます。 それぞれについて、通知テンプレートを使用する必要があります。

```{note}
Liferay Commerceの通知機能を使用するには、最初にLiferay Digital Experience Platform（DXP）のメール設定を構成します。 詳しくは、 [メールの構成](https://learn.liferay.com/dxp/latest/ja/installation-and-upgrades/setting-up-liferay/configuring-mail.html) をご覧ください。
```

## ストアメール通知設定の構成

Liferay Commerceのメール設定が構成されたら、 ［**コントロールパネル**］ &rarr; ［**commerce**］ &rarr; ［**チャネル**］ に移動して、ストアのメール通知設定を作成します。 メール通知設定は[チャネル](../../store-management/channels/introduction-to-channels.md)ごとに構成されます。 [アクセラレータ](../../starting-a-store/accelerators.md)を使用すると、最初にストア、カタログ、およびチャネルが作成されます。

![すぐに使える通知テンプレート。](./store-emails/images/02.png)

## イベントトリガー

メール通知をトリガーできるイベントは10個あります。 標準の通知テンプレートの1つを使用して、標準化されたメール通知を作成します。

| 通知タイプ                | イベント                              |
|:-------------------- |:--------------------------------- |
| 注文済み                 | ストアは注文を受けました。                     |
| 注文処理                 | ストアは注文の処理を開始しました。                 |
| 注文は出荷待ちです            | 注文の出荷準備が完了しました。                   |
| 注文を一部出荷しました          | アイテムが個別に出荷される場合は、お客様に通知されます。      |
| 注文を出荷しました            | 注文は出荷されました。                       |
| 注文が完了しました            | 注文書が送信され、完了と表示される                 |
| サブスクリプションを更新しました     | サブスクリプションの更新（定期注文）                |
| サブスクリプションが有効になりました   | サブスクリプションの有効化                     |
| サブスクリプションが中断されました    | 店舗による審査または措置の保留によるサブスクリプションの一時停止。 |
| サブスクリプションがキャンセルされました | サブスクリプションのキャンセル                   |

![チャンネルに通知テンプレートを設定する。](./store-emails/images/01.png)

## 通知キューの表示

チャネルの ［**Notification Queue**］ ですべてのメール通知を表示できます。 ここでは、イベントによってトリガーされたメールのステータスを確認できます。

![通知キューには、トリガーされた通知のリストが含まれています。](./store-emails/images/03.png)

デフォルトでは、システムは未送信の通知がないか15分間隔で通知キューをチェックします。 チェック間隔の変更の詳細は、[commerce通知キューの設定](./configuring-the-commerce-notification-queue.md)の記事を参照してください。

## メール通知テンプレートのカスタマイズ

**メール設定** と **本文** フィールドのキー値に置き換えられる独自のテキストとワイルドカード値で通知テンプレートをカスタマイズすることが可能です。 ワイルドカードには、お客様の名前、注文ID、配送先住所、請求先住所、オーダー内の商品リストが含まれます。

たとえば、 ［**メールの本文**］ フィールドには次のものが含まれます。

```
[%ORDER_CREATOR%]様、

お客様のご注文 ［%ORDER_ID%］ は ［%ORDER_SHIPPING_ADDRESS%］に出荷されました。
```

そして、メール送信時にワイルドカードを該当する内容に置き換えます。

詳細は、[通知テンプレート変数リファレンスガイド](./notification-template-variables-reference-guide.md)を参照してください。

## 注文通信履歴の表示

注文に関連するメール通知は追跡され、注文の ［**メール**］ タブで確認することができます。 ［**コントロールパネル**］ → ［**commerce**］ → ［**注文**］ に移動します。 注文IDをクリックし、次に ［**Email**］ タブをクリックします。 詳細は、[注文情報](../../order-management/orders/order-information.md)を参照してください。

![トリガーされた通知は、注文の［メール］タブで確認することができます。](./store-emails/images/04.png)

## 追加情報

* [通知テンプレートの使用](./using-notification-templates.md)
* [commerce通知キューの設定](./configuring-the-commerce-notification-queue.md)
* [通知テンプレート変数リファレンスガイド](./notification-template-variables-reference-guide.md)
