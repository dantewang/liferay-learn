
# 저수준 검색 옵션 이해

> 저수준 검색은 [Elasticsearch](../../installing-and-upgrading-a-search-engine/elasticsearch.html)에서만 작동합니다.

낮은 수준의 검색은 Liferay 검색 인덱스에서 문서를 검색하는 데 사용되는 인프라인 검색 및 인덱싱 프레임워크를 거치지 않습니다.

낮은 수준의 검색에 대한 일반적인 사용 사례는 Liferay DXP 인덱스 이외의 인덱스를 쿼리하는 것입니다. 기본적으로 [검색 페이지](../working-with-search-pages/search-pages.md) Liferay DXP 색인을 검색하지만 동일한 Elasticsearch 클러스터에 있는 한 다른 색인을 검색할 수도 있습니다.

낮은 수준의 검색 옵션 위젯을 검색 페이지에 추가하고 검색을 대체 인덱스로 지정하도록 구성합니다. 동일한 페이지에서 여러 인덱스를 검색하려면 여러 하위 수준 검색 옵션 위젯을 추가하고 고유한 인덱스 이름 및 통합 검색 키로 각 위젯을 구성할 수 있습니다.

대체 인덱스 검색은 Liferay DXP 권한 확인 메커니즘을 우회하여 검색 엔진이 반환하는 모든 결과를 표시하는 낮은 수준의 작업입니다. 이러한 이유로 관리자만 하위 수준 검색 옵션 위젯을 추가하고 구성할 수 있습니다.

하위 수준 검색 옵션 위젯을 사용하려면 검색 페이지에 추가하십시오.

1. 페이지에서 추가 아이콘(![Add app icon](../../../images/icon-add-widget.png))을 클릭하여 위젯 추가 메뉴를 엽니다.

   ![낮은 수준의 검색 옵션 위젯은 검색 위젯 아래에 있습니다.](./understanding-low-level-search-options/images/01.png)

1. 하위 수준 검색 옵션 위젯(검색 섹션에서)을 끌어서 페이지에 놓습니다.

1. 옵션 아이콘(![Options icon](../../../images/icon-app-options.png))을 클릭하고 *구성*클릭합니다.

   ![구성 링크를 클릭하여 위젯 구성을 엽니다.](./understanding-low-level-search-options/images/02.png)

위젯에는 구성할 수 있는 다양한 옵션이 있습니다.

**[Liferay 7.3+] 연결 ID:** 검색에 사용할 연결의 연결 ID를 선택합니다.

**색인:** 검색할 대체 색인의 이름을 쉼표로 구분하여 입력합니다. 일반적으로 Liferay 회사 색인 이름을 입력하면 안 됩니다.

**반환할 필드:** 검색 엔진에서 반환할 저장된 필드의 이름을 쉼표로 구분된 목록에 입력합니다. 저장된 모든 필드를 반환하려면 비워 두십시오.

**포함할 기여자:** 검색에 포함할 등록된 검색 기여자의 ID를 각 `SearchRequestContributor`의 정규화된 클래스 이름(예: `com.liferay.docs.request.contributor. MySearchRequestContributor`). 설정하지 않으면 등록된 모든 검색 기여자가 적용됩니다.

**제외할 기여자:** 검색에서 제외할 등록된 검색 기여자의 ID를 쉼표로 구분된 목록에 입력합니다. 설정하지 않으면 등록된 모든 검색 기여자가 적용됩니다.

```{note}
이러한 *Contributors*는 확장점(SPI)인 `com.liferay.portal.search.spi.searcher.SearchRequestContributor` 인터페이스(`com.liferay.portal.search.spi` 아티팩트에서 제공)를 구현하는 구성 요소입니다. 검색 요청을 가로채고 쿼리 부분을 추가합니다.
```

**통합 검색 키:** 이 위젯이 참여하는 대체 검색의 키를 입력합니다. 설정하지 않으면 이 위젯이 기본 검색에 참여합니다. 이 값은 일반적으로 애플리케이션 정의 색인의 이름입니다.

**[Liferay 7.4+] 속성:** 검색 컨텍스트에 키/값 속성을 추가합니다. 이 섹션은 [검색 청사진 적용](../../liferay-enterprise-search/search-experiences/search-blueprints/using-a-search-blueprint-on-a-search-page.md에 가장 유용합니다. ) 검색 페이지로. 개발 및 테스트 목적으로도 사용할 수 있습니다. 맞춤 코드에서 읽을 수 있는 페이지의 검색 컨텍스트에 속성을 추가합니다(예: `searchContext.getAttribute("key")`).

## 낮은 수준의 검색 결과 표시

Liferay 회사 인덱스(예: `liferay-20097`)로 인덱싱된 자산은 `ModelSummaryContributor` 구현하여 검색 결과 위젯에서 사용되는 자체 디스플레이 로직을 제공할 수 있습니다. 낮은 수준의 검색은 가져올 요약이 없기 때문에 다른 표시 논리를 사용합니다.

* 하나의 필드만 구성된 경우 제목 필드로 나타납니다(크고 굵은 텍스트가 표시됨).
* 두 개의 필드가 있는 경우 첫 번째 필드는 제목(크고 굵은 텍스트)으로 사용되고 두 번째 필드는 설명 필드입니다.
* 두 개 이상의 필드가 있는 경우 첫 번째 필드는 제목 필드(크고 굵은 텍스트 포함)로 사용되고 나머지는 설명 필드로 매시업됩니다.

![저수준 검색 프레임워크에는 매력적인 결과 요약을 즉석에서 생성하는 논리가 포함되어 있습니다.](./understanding-low-level-search-options/images/04.png)

## 저수준 검색 및 권한 확인

권한 확인은 하위 수준 검색을 통해 사용할 수 없습니다. 저수준 검색으로 회사 인덱스까지 검색하면 중요한 [권한 확인](../search-results/search-results-behavior.md#permissions-and-search-results) 우회합니다. 거의 항상 권한 확인의 이점을 원하지만 의도적으로 권한 확인을 우회하는 한 가지 가능한 사용 사례는 검색 페이지에 액세스하는 모든 사람이 회사 색인의 모든 결과에 액세스할 수 있어야 하는 관리자 전용 검색 페이지입니다.

## 낮은 수준의 검색 및 관련성

관련성 점수는 인덱스 내에서만 의미가 있습니다. 별도의 인덱스에서 가져온 결과는 서로에 대해 정확하게 점수를 매길 수 없습니다. 따라서 별도의 검색 결과 위젯에 각 색인의 결과를 표시하는 것이 가장 좋습니다. 아래 예는 이를 보여줍니다.

## 예제 1: 대체 인덱스 검색

1. 기본 검색 페이지에서 테스트하거나 새로운 [검색 페이지](../working-with-search-pages/search-pages.md)생성 여부에 관계없이 다음 위젯을 포함합니다(여분의 위젯을 제거하면 연습이 간단해 지지만 작동하는 데 필수는 아닙니다).

    * 저수준 검색 옵션
    * 커스텀 필터
    * 검색 바
    * 수입 카테고리 탐색

1. 옵션 아이콘(![Options icon](../../../images/icon-app-options.png))을 클릭하고 *구성*선택하여 대체 검색에 참여하도록 모든 위젯을 구성하십시오. 각각에 대해 Federated Search Key 설정에 *liferay-0* 입력합니다.
   
   대체 검색에 적절하게 반응할 것으로 예상되는 모든 검색 위젯은 통합 검색 키로 구성되어야 합니다.

1. 하위 수준 검색 옵션 위젯에서 대체 색인의 색인 이름을 추가하여 추가 구성을 만듭니다.
   
   *인덱스* 설정에 하나 이상의 인덱스 이름을 입력합니다. 이 예를 따르려면 *liferay-0*사용하십시오.

1. 검색 표시줄의 기본 쿼리 매개변수(*q*)를 사용하고 검색에 쿼리를 추가하도록 사용자 지정 필터를 구성합니다.
   
   Custom Parameter Name 필드에 _q_ 입력합니다.
   
   필터 필드 아래에 _제목_ 입력하여 쿼리에 제목 필드를 추가합니다.
   
   필터 쿼리 유형에서 _일치_ 선택합니다.
   
   대체 색인을 검색하기 위해 기본 쿼리를 재정의하고 있으므로 기본적으로 쿼리에는 아무것도 없습니다. 검색 엔진으로 전송하려는 모든 쿼리 절은 [사용자 지정 필터](./filtering-search-results.md) 위젯을 사용하여 수동으로 추가해야 합니다. 

   ```{important}
   검색 표시줄의 키워드 매개변수 이름 설정의 기본값과 일치하도록 사용자 정의 매개변수 이름을 `q`로 설정합니다. 일치하는 매개변수는 검색창에 입력된 사용자의 키워드가 사용자 정의 필터 위젯에 적용되도록 합니다. 검색창의 Keywords Parameter Name에 사용자 정의 값이 설정되어 있으면 `q` 대신 해당 값을 사용하십시오.
   ```

여기 예제를 따라 *liferay-0*검색하는 경우 검색창에서 *dynamic* 검색하십시오. 다음과 같은 결과가 표시됩니다.

![저수준 검색 결과의 예.](./understanding-low-level-search-options/images/03.png)

## 예 2: Liferay 회사 인덱스 및 추가 인덱스 검색

Liferay의 회사 인덱스(예: `liferay-20098`)의 결과 집합과 [Liferay](../working-with-search-pages/search-pages.md) [이 예에서는 `liferay-0` ](../../installing-and-upgrading-a-search-engine/elasticsearch.md) 사용하여 데모 목적):

1. 이 위젯을 [_Low Level Search_라는 새 페이지](./../../../site-building/creating-pages/using-widget-pages/adding-widgets-to-a-page.md) 에 추가합니다.
   
   * 하나의 하위 수준 검색 옵션
   * 두 개의 [검색 막대](../../getting-started/searching-for-content.md#using-the-search-bar)
   * 두 개의 [검색 결과](./configuring-the-search-results-widget.md)
   * 하나 [맞춤 필터](./filtering-search-results.md) 
     

   ```{tip}
   1-2-1 열(50/50) [페이지 레이아웃](./../../../site-building/creating-pages/page-settings/configuring-individual-pages.md#page- 레이아웃)이 이 예에서는 편리합니다.
   ```

1. 위젯을 구성합니다.


   | 검색 위젯       | 위젯 구성                                                                                                                                                | 설명                                                                                                                                                                        |
   | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | 저수준 검색 옵션   | **인덱스:** `liferay-0`<br />**통합 검색 키:** `liferay-0`                                                                                             | 이렇게 하면 대체 인덱스 검색이 설정됩니다. 이 경우 데모 목적으로만 사용되는 또 다른 Liferay 제어 인덱스입니다. 통합 검색 키는 기억하기 쉬운 문자열일 수 있습니다. 이 예제는 단일 추가 인덱스만 검색하므로 인덱스 자체와 동일하게 이름이 지정됩니다.                          |
   | 검색 결과(첫 번째) | -                                                                                                                                                    | 기본적으로 검색 결과 위젯은 Liferay 회사 인덱스에 대해 미리 구성되어 있으므로 모든 기본값을 그대로 둘 수 있습니다.                                                                                                     |
   | 검색 결과(두 번째) | **통합 검색 키:** `liferay-0`                                                                                                                             | 표시할 필드 제어와 같은 추가 구성이 있습니다. 이 옵션을 공백으로 두면 [Liferay가 알아낼 것을 요청합니다](#displaying-low-level-search-results).                                                                   |
   | 검색창(첫 번째)   | -                                                                                                                                                    | 첫 번째 검색 표시줄은 기본적으로 회사 색인을 검색하도록 구성되어 있으므로 기본값을 그대로 둡니다.                                                                                                                   |
   | 검색창(두 번째)   | **보이지 않음:** `참`<br />**연합 검색 키:** `liferay-0`                                                                                                  | 사용자 입력에는 하나의 검색 표시줄만 사용되므로 이 표시줄은 보이지 않아야 합니다. 중요한 것은 두 검색 표시줄 위젯에서 키워드 매개변수 이름의 기본값을 그대로 두었다는 것입니다. 이 검색 표시줄은 페이지에 표시되는 검색 표시줄과 매개변수를 공유하기 때문에 사용자가 입력한 검색어를 수집할 수 있습니다. |
   | 커스텀 필터      | **필터 필드:** `title_en_US`<br />**발생:** `should`<br />**맞춤 매개변수 이름:**`q`<br />**보이지 않음:** `true`<br />**통합 검색 키:** `liferay-0` | 사용자 정의 필터 위젯은 `liferay-0` 인덱스의 제목 필드와 일치해야 합니다. 더 많은 필터가 필요한 경우 페이지에 더 많은 사용자 정의 필터 위젯을 추가하십시오.                                                                           |


   ```{important}
   검색 표시줄의 키워드 매개변수 이름 설정의 기본값과 일치하도록 사용자 정의 매개변수 이름을 `q`로 설정합니다. 일치하는 매개변수는 검색창에 입력된 사용자의 키워드가 사용자 정의 필터 위젯에 적용되도록 합니다. 검색창의 Keywords Parameter Name에 사용자 정의 값이 설정되어 있으면 `q` 대신 해당 값을 사용하십시오.
   ```

하위 수준 검색 페이지 기능을 테스트하려면

1. 사이트에 하나 이상의 자산(예: 블로그 항목, 웹 콘텐츠 기사 등)을 추가하고 생성한 모든 자산에 _콘텐츠_ 단어를 포함합니다. 

1. 하위 수준 검색 페이지의 검색 표시줄에 _콘텐츠_ 입력하고 두 인덱스 모두에서 결과를 얻는지 확인합니다.

![서로 다른 인덱스의 결과는 별도의 검색 결과 위젯에 가장 잘 표시됩니다.](./understanding-low-level-search-options/images/05.png)

이제 클러스터의 모든 Elasticsearch 인덱스에 대한 검색에 참여하도록 즉시 사용 가능한 검색 위젯을 구성할 수 있습니다.
