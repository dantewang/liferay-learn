# 시스템 수준에서 SAML 구성

포털 인스턴스가 SAML 인증을 활성화하도록 허용하기 전에 해당 인스턴스가 작동할 기반을 갖도록 시스템 수준에서 구성해야 합니다. 예를 들어 포털 인스턴스가 SAML을 구성하는 것을 원하지 않을 수 있으며 키 저장소를 파일 시스템에서 문서 라이브러리로 이동해야 합니다. 이것은 모두에게 구성 문제를 야기합니다. 먼저 시스템 수준 옵션을 구성하는 것이 좋습니다.

## 키 저장소 관리자 대상 선택

1. 관리자 자격 증명으로 Liferay DXP에 로그인하고 _제어판_ &rarr; _시스템 설정_ &rarr; _보안_ &rarr; _SSO_ &rarr; _SAML KeyStoreManager 구현 구성_으로 이동합니다.

1. _파일 시스템_ (기본값) 또는 _문서 라이브러리_을 선택합니다.

1. _업데이트_을 클릭합니다.

![파일 시스템 또는 문서 라이브러리를 선택합니다.](./configuring-saml-at-the-system-level/images/01.png)

두 사이트 중 하나에 대해 백업을 구성해야 합니다.

## SAML 구성

기본 구성이 시스템에 적합한지 확인합니다.

1. _제어판으로 이동_ &rarr; _시스템 설정_ &rarr; _보안_ &rarr; _SSO_ &rarr; _SAML 구성_.

1. 키 저장소 경로를 설정하십시오. 기본적으로 [Liferay Home](../../../reference/liferay-home.md) 디렉토리에 있습니다. 문서 라이브러리를 키 저장소의 사이트로 선택한 경우 해당 경로는 현재 포털 인스턴스에 대해 `/saml/keystore.jks` 로 하드 코딩되며 여기에 무언가를 입력해도 아무런 효과가 없습니다.

1. 키 저장소에 액세스하기 위한 비밀번호를 설정하십시오.

1. 다른 옵션(아래 참조)을 검토하고 그에 따라 수정한 다음 _저장_을 클릭합니다.

다음과 같은 다양한 옵션을 설정할 수 있습니다.

**키 저장소 유형:** 키 저장소 유형을 설정합니다. 기본값은 _jks_ 또는 Java 키 저장소입니다. [Java에서 지원하는](https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html#keystore-types) 옵션을 선택할 수 있습니다.

**SSO 세션 확인 간격:** IdP는 여기에 입력한 매 분마다 만료된 세션을 확인해야 합니다. 

**런타임 메타데이터 새로 고침 간격:** 여기에 입력하는 매초마다 피어 SAML 엔터티를 새로 고칩니다. 

**재생 캐시 기간:** 여기에 입력한 밀리초가 만료되면 IdP 메시지 캐시 항목을 만료합니다. 메시지 캐싱은 메시지 재생 공격으로부터 보호합니다. 

**인증 요청 확인 간격:** SP는 만료된 인증 요청이 분 단위로 이 기간에 도달하면 제거합니다. 

**Authn 요청 최대 기간:** Authn 요청이 유효해야 하는 시간을 밀리초 단위로 입력합니다. 

**메시지 확인 간격:** SP는 만료된 항목이 이 시간(분)보다 오래된 경우 IdP 메시지 캐시에서 제거해야 합니다. 

**구성할 ID 제공자 역할 활성화:** 이 확인란을 선택하면 이 Liferay DXP 설치의 포털 인스턴스가 IdP 역할을 갖도록 허용합니다. 
