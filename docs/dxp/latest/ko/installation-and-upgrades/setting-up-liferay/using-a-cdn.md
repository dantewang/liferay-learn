# CDN 사용

CDN(Content Delivery Network)은 정적 파일 기반 콘텐츠를 캐싱하기 위한 분산 인프라입니다. 방문자가 사이트를 방문하면 가장 가까운 서버에서 정적 콘텐츠가 로드되어 요청 속도가 빨라집니다.

CDN은 캐싱 프록시로 작동합니다. 즉, 정적 콘텐츠가 로컬 서버에 복사되면 빠르고 쉽게 검색할 수 있도록 캐시에 저장됩니다. 이렇게 하면 브라우저가 지구 반대편이 아닌 거리에 있는 로컬 서버에서 정적 리소스를 다운로드할 수 있으므로 대기 시간이 개선됩니다. 알고리즘은 요청에 가장 가까운 서버를 찾습니다. 아래 그림은 대기 시간을 최소화하기 위해 지리적 근접성을 사용하는 것을 보여줍니다.

![ CDN을 사용하면 사용자가 훨씬 가까운 로컬 서버에서 정적 리소스를 요청할 수 있으므로 다운로드 시간이 단축됩니다.](./using-a-cdn/images/01.png)

지도의 빨간색 선은 서버에서 사용자까지 요청이 이동한 필수 거리를 나타냅니다. 요청에 대한 대기 시간 감소와 애플리케이션 서버의 부하 감소로 인해 CDN은 성능을 향상시키는 훌륭한 옵션입니다.

Liferay가 CDN을 통해 지원하는 리소스는 다음과 같습니다.

* Liferay 및 맞춤형 플러그인에 포함된 파일
* 문서 및 미디어에 저장된 항목
* 동적으로 생성된 CSS *
* 동적으로 생성된 JavaScript *
* 동적으로 생성된 이미지 *

**\* CDN 동적 리소스를 활성화해야 합니다.**

```{note}
CDN은 외부 소스에서 동적으로 로드되는 리소스를 제공하지 않습니다.
```

## Liferay CDN 요구 사항

CDN은 다음 요구 사항을 충족해야 합니다.

* **동적으로 리소스 저장 및 검색:** CDN이 작동하기 위해 수동으로 아무것도 업로드할 필요가 없는지 CDN 공급자에게 확인하십시오. CDN은 자동으로 리소스를 가져와야 합니다.

* **투명 프록시처럼 작동:** 요청은 먼저 CDN으로 이동합니다. CDN에 요청된 리소스가 없으면 CDN은 원본(Liferay)에 동일한 요청을 다시 만들고 리소스를 캐시한 다음 리소스를 제공합니다.

적격한 CDN을 설정한 후 이를 사용하도록 Liferay를 구성합니다.

## CDN을 사용하도록 Liferay 구성

다음은 CDN을 구성하는 두 가지 방법입니다.

1. [포털 속성](../reference/portal-properties.md) 파일에서 [Content Delivery Network 속성](https://learn.liferay.com/reference/latest/en/dxp/propertiesdoc/portal.properties.html#Content%20Delivery%20Network) 을 설정합니다.

1. 제어판 사용

제어판에서 CDN을 구성하는 방법은 다음과 같습니다.

1. Liferay에서 **글로벌 메뉴**(![Global Menu](../../images/icon-applications-menu.png))을 클릭하고 **제어판** 탭을 선택합니다.

1. 구성 범주에서 **인스턴스 설정** 을 선택합니다. 인스턴스 설정 페이지가 나타납니다.

1. 가상 인스턴스 범위 탐색에서 **일반** 을 클릭하십시오. 일반 기본 구성 페이지가 나타나고 다음 세 가지 CDN 관련 필드가 포함됩니다.

    * **CDN 호스트 HTTP**
    * **CDN 호스트 HTTPS**
    * **CDN 동적 리소스 활성**

![제어판에서 CDN을 구성합니다.](./using-a-cdn/images/02.png)

CDN 호스트 URL을 지정할 때 프로토콜과 도메인을 포함해야 합니다.

**CDN 호스트 HTTP:** `http://cdnhost1.liferay.com` **CDN 호스트 HTTPS:** `https://cdnhost2.liferay.com`

**CDN 동적 리소스** 이 선택되면(기본값) Liferay는 CDN을 통해 동적으로 생성된 CSS, JavaScript 및 이미지를 제공합니다. 이를 비활성화하면 리소스 지연 로드를 지원하지 않는 CDN을 사용할 수 있습니다.

CDN 호스트를 구성했습니다. 이제 Liferay는 이전 호스트를 새 CDN 호스트로 대체하는 정적 리소스 URL을 생성하므로 나중에 CDN에서 자동으로 캐시되고 제공됩니다.

## 사용자 지정 플러그인에서 CDN 사용

CDN에 사용자 지정 리소스를 추가하려면 플러그인에 패키지하십시오. 예를 들어 테마 플러그인에 리소스를 포함하거나 포틀릿 플러그인의 `liferay-portlet.xml` 파일에서 JavaScript 파일을 참조하십시오.

CDN을 통해 리소스를 사용하려면 `themeDisplay.getCDNDynamicResourcesHost()`을 사용하여 리소스 참조에 CDN 호스트 이름을 붙입니다.

```{important}
권한 확인 또는 복잡한 정책 액세스가 필요한 CDN에 아무 것도 넣지 마십시오.
```

이제 CDN을 사용하여 사이트의 정적 리소스를 더 빠르게 제공하는 방법을 알게 되었습니다.