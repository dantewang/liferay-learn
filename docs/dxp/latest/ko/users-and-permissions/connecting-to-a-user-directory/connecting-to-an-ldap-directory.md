# LDAP 디렉토리에 연결

LDAP(Lightweight Directory Access Protocol) 서버는 Liferay DXP의 공통 사용자 저장소입니다. 시스템 설정의 시스템 범위 또는 인스턴스 설정의 인스턴스 범위에서 LDAP를 구성할 수 있습니다. 사용자는 LDAP에서 가져오거나 LDAP으로 내보낼 수 있습니다.

## 새 LDAP 서버 연결 추가

인스턴스 수준에서 LDAP 구성 설정에 액세스하려면

1. *제어판 &rarr; 구성* &rarr; *인스턴스 설정*로 이동합니다.

    ![LDAP 구성은 인스턴스 수준과 시스템 수준에서 사용할 수 있습니다.](./connecting-to-an-ldap-directory/images/01.png)

1. *LDAP* &rarr; 를 클릭하고 *서버*를 클릭합니다.
1. *추가* 버튼을 클릭하여 LDAP 서버 연결을 추가합니다.
1. LDAP 서버에 대한 구성 값을 입력하십시오. 자세한 내용은 [구성 참조](#ldap-server-configuration-reference) 을 참조하십시오.

그러나 올바른 기본값에 대한 "최선의 추측"을 나타내므로 나머지 구성을 사용자 지정해야 할 수도 있습니다. 기본 속성 매핑은 일반적으로 사용자가 로그인을 시도할 때 Liferay 데이터베이스와 다시 동기화하기에 충분한 데이터를 제공합니다. LDAP 서버에 대한 연결을 테스트하려면 *LDAP 연결 테스트* 버튼을 클릭하십시오.

둘 이상의 LDAP 서버가 있는 경우 위쪽/아래쪽 화살표를 사용하여 기본 설정 순서대로 서버를 정렬할 수 있습니다. 추가하는 LDAP 서버 수에 관계없이 각 서버에는 동일한 구성 옵션이 있습니다.

### 시스템 설정 범위 사용

또는 시스템 설정 메뉴를 통해 또는 OSGi `.config` 파일을 사용하여 시스템 설정 범위에서 LDAP 서버 연결을 정의할 수 있습니다.

```{tip}
*인스턴스 설정*의 LDAP 서버 구성 화면에는 LDAP 연결 구성을 지원하는 유틸리티가 있습니다. 이 유틸리티를 사용하여 시스템 설정 범위에 설정을 입력하기 전에 먼저 설정의 유효성을 검사할 수 있습니다.
```

`.config` 파일을 사용하는 가장 쉬운 방법은 GUI를 사용하고 구성을 내보내는 것입니다. 그런 다음 결과 `.config` 파일을 필요할 때마다 사용할 수 있습니다(예: 클러스터의 다른 노드).

```{note}
LDAP 서버 구성에 `config` 파일을 사용하려면 서버가 시스템 범위가 아닌 인스턴스 범위에서 정의되기 때문에 내보낸 구성 파일에 가상 인스턴스 ID(소스에서 변수 이름은 `companyId`임)를 지정해야 합니다. . 이렇게 하려면 다음과 같이 파일의 어딘가에 가상 인스턴스 ID를 지정합니다.

    companyId=1234

*Control Panel* -> *Configuration* -> *Virtual Instances*에서 가상 인스턴스 ID를 찾을 수 있습니다.
```

## LDAP 서버 구성 참조

**서버 이름:** LDAP 서버의 이름을 입력합니다.

**기본값:** 여러 공통 디렉토리 서버가 여기에 나타납니다. 이 중 하나를 사용하는 경우 이를 선택하여 나머지 양식을 해당 디렉터리의 기본값으로 채웁니다.

이러한 설정은 LDAP에 대한 연결을 다룹니다.

**기본 공급자 URL:** LDAP 서버에 대한 링크입니다. Liferay 서버가 LDAP 서버와 통신할 수 있는지 확인하십시오. 두 시스템 사이에 방화벽이 있는 경우 적절한 포트가 열려 있는지 확인하십시오.

**기본 DN:** 일반적으로 조직을 따라 모델링되는 LDAP 디렉토리의 기본 고유 이름입니다. 다음과 같을 수 있습니다. `dc=companynamehere,dc=com`.

**프린시펄:** 기본 LDAP 관리자 사용자 ID가 여기에 채워집니다. 관리자 ID가 다른 경우 해당 자격 증명을 대신 사용하십시오. Liferay는 이 ID를 사용하여 LDAP와 사용자 계정을 동기화하기 때문에 관리 자격 증명이 필요합니다.

**자격 증명:** LDAP 관리 사용자의 비밀번호를 입력합니다.

## 검문소

Liferay의 LDAP 연결을 미세 조정하기 전에 다음 단계를 수행했는지 확인하십시오.

1. LDAP 연결이 활성화되었습니다. 필요에 따라 바인딩된 사용자만 로그인할 수 있도록 LDAP 인증이 필요할 수 있습니다.

1. *내보내기/가져오기*: 클러스터 환경에 있는 사용자의 경우 시작 시 모든 노드에서 대규모 가져오기가 발생하지 않도록 시작 시 가져오기/내보내기 활성화를 비활성화해야 합니다.

1. LDAP 서버를 추가할 때 *서버 이름*, *기본값*, *연결* 값이 정확합니다. 저장하기 전에 항상 *테스트 LDAP 연결* 을 클릭하는 것이 좋습니다.

## SSL을 사용하여 LDAP 서버에 연결

SSL 모드에서 LDAP 디렉토리를 실행하여 네트워크에서 자격 증명 정보를 암호화하는 경우 두 시스템 간에 암호화 키와 인증서를 공유하려면 추가 단계를 수행해야 합니다.

예를 들어 LDAP 디렉토리가 Windows Server 2003의 Microsoft Active Directory인 경우 다음과 같이 인증서를 공유합니다.

1. *시작* &rarr; *관리 도구* &rarr; *인증 기관*을 클릭합니다.

1. 인증 기관인 시스템을 강조 표시하고 마우스 오른쪽 버튼으로 클릭한 다음 *속성*을 클릭합니다.

1. 일반 메뉴에서 *인증서 보기*을 클릭합니다.

1. 자세히 보기를 선택하고 *파일로 복사*을 클릭합니다. 결과 마법사를 사용하여 인증서를 파일로 저장합니다.

1. 다음과 같이 인증서를 *cacerts 키 저장소* 로 가져옵니다.

    ```bash
    keytool -import -trustcacerts -keystore /some/path/java-8-jdk/jre/lib/security/cacerts -storepass changeit -noprompt -alias MyRootCA -file /some/path/MyRootCA.cer
    ```

    `keytool` 유틸리티는 Java SDK의 일부로 제공됩니다.

1. 제어판의 LDAP 페이지로 돌아갑니다.

1. 다음과 같이 프로토콜을 `ldaps` 로, 포트를 `636` 으로 변경하여 기본 DN 필드의 LDAP URL을 보안 버전으로 수정합니다.

    ```
    ldaps://myLdapServer호스트 이름:636
    ```

변경 사항을 저장합니다. 이제 LDAP와의 통신이 암호화됩니다.

Liferay DXP가 동기화를 위해 LDAP의 사용자를 일치시키는 방법을 조정하거나 구성하려면 [가져오기 및 내보내기 구성](./configuring-user-import-and-export.md)을 참조하십시오.
