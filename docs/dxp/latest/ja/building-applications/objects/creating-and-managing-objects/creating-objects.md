# オブジェクトの作成

{bdg-secondary}`Liferay 7.4以降で利用可能`

Liferay Objectは、Liferay UIの開発機能を提供します。 オブジェクトポートレットを使用すると、コードを記述したり、モジュールを手動でデプロイしたりすることなく、完全に統合されたLiferayアプリケーションを構築できます。 このプロセスには、オブジェクトの初期ドラフトの [作成](#creating-object-drafts) 、オブジェクトドラフトの [編集](#editing-object-drafts) 、最後にドラフトを [公開](#publishing-object-drafts) して新しいアプリケーションを作成することが含まれます。 オブジェクトドラフトを公開すると、完全に統合されたLiferayアプリケーションが作成され、オブジェクトポートレットを介していつでも[管理および拡張](./managing-objects.md)できます。

## オブジェクトドラフトの作成

オブジェクトドラフトは、オブジェクトアプリケーションを作成するために必要なデータを格納したアプリケーションテンプレートです。 以下の手順でオブジェクトドラフトを作成します。

1. **グローバルメニュー**（![Global Menu](../../../images/icon-applications-menu.png)）を開き、 ［**コントロールパネル**］ タブに移動して、 ［**オブジェクト**］ をクリックします。

1. **追加** ボタン（![Add Button](../../../images/icon-add.png)）をクリックします。

1. オブジェクトのドラフトにこれらの詳細を提供します。
   
   **Label** : Objects 管理画面およびサポートされているアプリケーションコンテキスト（ワークフロー、表示ページテンプレート、フォームなど）において、オブジェクトを識別します。
   
   **Plural Label** : UIにおけるオブジェクトアプリケーションの表示名を決定します。
   
   **オブジェクト名** : オブジェクトの `定義.名` を決定し、オブジェクトが公開された後は変更できないようにする。
   
   <!--TASK: when released, uncomment and update img & alt text 

   **Storage Type** : Determines whether the Object's data is stored in Liferay (**Default**) or in an external system (**Salesforce**).

   ```{important}
   Selecting an external system imposes limitations on Object customization. 
   
   Currently, Liferay only supports Salesforce for external storage. See [Using the Salesforce Storage Type](../integrating-objects-with-third-party-services/storing-object-data-in-an-external-system/using-the-salesforce-storage-type.md) for more information.
   ```
   -->
   
   ![オブジェクトドラフトの「ラベル」「複数形ラベル」「名前」を入力します。](./creating-objects/images/01.png)

1. ［**Save**］ をクリックします。

保存されると、設定やデータ要素のない空白のオブジェクトドラフトが作成されます。 下書きは、Objects管理画面でシステムオブジェクトと一緒に表示することができます。 </a> 作成プロセスを終了するには、 ドラフトを編集し、 [](#publishing-object-drafts) それをLiferayインスタンスに公開する必要があります。</p> 

![新しいオブジェクトのドラフトは、Objects adminで確認できます。](./creating-objects/images/02.png)

## オブジェクトドラフトの編集

オブジェクトを公開する前に、要素の追加や設定を行うことができます。 これには、フィールドの追加、バリデーションの定義、データのスコープの設定などが含まれます。

```{note}
フィールド、リレーションシップ、レイアウトを追加するたびに、オブジェクトドラフトが自動的に保存されます。 ただし、「詳細」タブで保存していない変更は、他のタブに移動すると失われます。
```

以下の手順でオブジェクトドラフトを編集します。

1. Objectsの管理画面から、新しく作成したオブジェクトのドラフトをクリックして、編集を開始します。
   
   オブジェクトの機能と設定オプションは、以下のタブに整理されています。詳細、フィールド、リレーションシップ、レイアウト、アクション、ビュー、バリデーション、ステート・マネージャーです。
   
   ![オブジェクトの機能と設定オプションは、8つのタブに整理されています。](./creating-objects/images/03.png)

1. **Fields** タブを開き、カスタムフィールドを追加します。 各フィールドは、特定のタイプの値を格納するためのデータベースカラムを表します。 詳細については、[オブジェクトへのフィールドの追加](./adding-fields-to-objects.md)を参照してください。
   
   デフォルトでは、すべてのオブジェクトに以下のシステムフィールドが含まれます。著者、作成日、外部参照コード、ID、変更日、およびステータス。
   
   ![フィールド]タブからオブジェクトにフィールドを追加します。](./creating-objects/images/04.png)

1. (オプション)**Relationships** タブに移動して、リレーションシップを追加します。 リレーションシップは、オブジェクト定義間の接続で、そのエントリーをリンクさせるために使用します。 詳細については、[オブジェクトリレーションシップの定義](./defining-object-relationships.md)を参照してください。
   
   ![リレーションシップタブからオブジェクトにリレーションシップを追加する。](./creating-objects/images/05.png)

1. (オプション)**レイアウト** タブに移動してレイアウトを追加します。 オブジェクトレイアウトは、オブジェクトエントリを作成したり表示したりする際に、フィールドやリレーションシップをどのように表示するかを決定します。 詳細については、[オブジェクトレイアウトの設計](./designing-object-layouts.md)を参照してください。 

   ```{note}
   カスタムレイアウトを追加せず、デフォルトとして設定した場合、オブジェクトはそのエントリに自動生成されたレイアウトを使用します。 このレイアウトでは、すべてのオブジェクト・フィールドがアルファベット順に表示される1つのタブがあり、リレーションシップは表示されません。 リレーションシップを表示するには、専用のリレーションシップタブを使用してカスタムレイアウトを作成する必要があります。
   ```

![レイアウトタブから、オブジェクトにカスタムレイアウトを追加します。](./creating-objects/images/06.png)

1. (オプション)カスタムアクションを追加するには、[アクション]タブに移動します。 各アクションは、設定されたトリガーに従って自動的に実行されるオペレーションを定義します。 詳しくは、 [オブジェクトアクションの定義](./defining-object-actions.md) をご覧ください。
   
   ![アクション]タブからオブジェクトにカスタムアクションを追加します。](./creating-objects/images/07.png)

1. (オプション) カスタムビューを追加するには、[Views] タブに移動します。 オブジェクトビューは、オブジェクトのアプリケーションページでエントリをどのように表示するかを決定します。 詳細については、[オブジェクトビューの設計](./designing-object-views.md)を参照してください。
   
   ![Views タブからオブジェクトにカスタムビューを追加します。](./creating-objects/images/08.png)

1. (オプション) バリデーションタブに移動し、バリデーションを追加します。 各バリデーションは、有効なフィールドエントリを決定するためのルールを設定します。 [Custom Validations の追加](./adding-custom-validations.md)を参照。
   
   ![Validations タブからオブジェクトにカスタムバリデーションを追加します。](./creating-objects/images/09.png)

1. (オプション) 状態フィールドをドラフトに追加した場合、そのフローを定義するために、State Managerタブに移動します。 詳しくは、 [カスタムステートの追加と管理](./adding-and-managing-custom-states.md) を参照してください。
   
   ![State Managerタブで、ステートフィールドのフローを定義する。](./creating-objects/images/10.png)

1. 詳細タブで、オブジェクトのドラフトを設定します。

1. (オプション) オブジェクトの名前、ラベル、または複数のラベルを変更します。
   
   ![オブジェクトの名前、ラベル、複数のラベルを変更します。](./creating-objects/images/11.png)

1. (オプション) エントリーのタイトルを選択します。 UIでオブジェクトエントリーを識別するために使用されるフィールドを決定します。 デフォルトでは、オブジェクトはIDフィールドを使用します。
   
   ![オブジェクトにフィールドを追加すると、そのフィールドをエントリーのタイトルとして選択することができます。](./creating-objects/images/12.png)

1. オブジェクトを選択する **スコープ** . これは、オブジェクトのデータがどのように保存されるかを決定するものである。
   
   **Company**(デフォルト)。Companyでスコープされた場合、オブジェクトのデータはLiferayインスタンスごとに保存されます。
   
   **Site** : Siteでスコープされた場合、オブジェクトのデータはSiteごとに保存されます。

1. (オプション) Liferay UI のどこに定義が表示されるかを決定するパネルカテゴリーキーを選択します。
   
   カンパニー・スコープ・オブジェクトの場合は、グローバルメニュー(![Global Menu](../../../images/icon-applications-menu.png))でタブとカテゴリーを選択します。
   
   サイトスコープのオブジェクトの場合、サイトメニュー(![Site Menu](../../../images/icon-menu.png))でセクションを選択します。
   
   UIメニューにアプリケーションを表示しない場合は、この値を空白にすることができます。
   
   ![オブジェクトのスコープとパネルカテゴリキーを選択します。](./creating-objects/images/13.png)

1. (オプション) アカウントによってオブジェクト エントリへのアクセスを制限するかどうかを決定します。 このオプションは、オブジェクトがAccountシステム・オブジェクトとリレーションシップを持っている場合にのみ使用できます。 詳しくは、 [アカウントによるオブジェクトデータへのアクセス制限](./using-system-objects-with-custom-objects/restricting-access-to-object-data-by-account.md) を参照してください。
   
   ![オブジェクトエントリへのアクセスをアカウントごとに制限するかどうかを決定する。](./creating-objects/images/14.png)

1. オブジェクトのウィジェットをサイト内で表示するか非表示にするかを決定する。
   
   有効にすると、ユーザーはオブジェクトをウィジェットとしてページに配置することができます。 詳細は、[Deploying Object Widgets in Sites](../deploying-object-widgets-to-sites.md)を参照してください。
   
   ![オブジェクトのウィジェットを表示するか非表示にするかを決定する。](./creating-objects/images/15.png)

1. ［**Save**］ をクリックします。

ドラフトの設定と編集が終わったら、 [パブリッシュ](#publishing-object-drafts) することができます。

## オブジェクトドラフトの公開

オブジェクトを公開することで、新しいアプリケーションが作成され、アクティブになります。 アクティブにすると、ユーザーはそのスコープとパネルカテゴリキーに従ってLiferay UIでアクセスすることができます。 オブジェクトを公開する前に、以下の情報を確認し、ドラフトを公開した場合の影響について理解してください。

### 公開設定時の処理

公開プロセスには、次の操作が含まれます。

* ドラフトのデータ定義を含むオブジェクトのデータベーステーブルが作成されます。

* CRUD操作用に新しいヘッドレスAPIが自動的に作成されます。

* オブジェクトのエントリを表示するためのコレクションプロバイダが作成されます。

* オブジェクトのページウィジェットが作成されます。

* オブジェクトはInfoフレームワークに統合されているため、 [表示ページテンプレート](../../../site-building/displaying-content/using-display-page-templates.md)のコンテンツタイプとして選択することができます。

* このオブジェクトは、 [Permissions framework](../understanding-object-integrations/permissions-framework-integration.md)と統合されているため、新しいアプリケーションとそのリソースのパーミッションを管理することができます。

* このオブジェクトはWorkflowフレームワークと統合されているので、オブジェクトのカスタムワークフローを構成することができます。

* オブジェクトはFormsと統合されているため、データの保存先としてオブジェクトを選択することができます。

### 公開されたオブジェクトの構成制限

{bdg-secondary}`7.4 U26+/GA26+ 用`

データの損失やシステムの競合を防ぐため、一部の設定オプションは、公開後にオブジェクトに対して削除されます。

* 公開オブジェクトの名前とスコープを変更することはできません。

* 公開時にオブジェクトに含まれていたフィールドは、削除することができません。

* 公開されたフィールドとリレーションシップのほとんどの構成オプションは変更できません。

オブジェクト、フィールド、リレーションシップのラベルは、公開後も編集やローカライズが可能ですが、ほとんどの設定オプションが削除されます。 オブジェクトについては、Panel Category Key を変更したり、新しいフィールド、リレーション、レイアウトを追加することができます。 リレーションシップについては、その削除タイプを設定することができます。

```{note}
Liferay 7.4 U25/GA25およびそれ以前のバージョンでは、ユーザーは公開されたオブジェクト定義を削除したり、公開時にオブジェクトに含まれているリレーションシップを削除したりすることはできません。
```

## 追加情報

* [オブジェクト](../../objects.md)
* [オブジェクトへのフィールドの追加](./adding-fields-to-objects.md)
* [オブジェクトリレーションの定義](./defining-object-relationships.md)
* [オブジェクトレイアウトの設計](./designing-object-layouts.md)
* [オブジェクトの管理](./managing-objects.md)
