# 集約フィールド

{bdg-secondary}`Liferay 7.4 U47+/GA47+`

集計フィールドは、関連テーブルのエントリーに対して基本的な計算を行い、その結果を表示します。 利用可能な [集約関数](#functions-reference) には回数、合計、平均、最小、最大が含まれます。 各関数は、フィールドの値の計算方法を決定します。 集計フィールドの値は読み取り専用です。

集約フィールドを含めるには、オブジェクトは1対多の関連の親側か、多対多の関連のいずれか側にある必要があります。 合計、平均、最小、最大関数を使用するには、関連オブジェクトが数値フィールド（整数、長整数、小数、小数の精度）を持っている必要があります。

集計フィールドを追加した後、 [フィルター](#using-aggregation-filters) を追加することができます。 これらのフィルターは、関連オブジェクトの日付、整数、または候補リストフィールドを使用して、計算に含まれるエントリーを制限できます。 すべてのフィルタ基準を満たすエントリーのみが、集計フィールドの計算に含まれます。

## 関数リファレンス

集計フィールドには、以下の機能を含めることができます。

| 関数 | Description                        |
|:-- |:---------------------------------- |
| 回数 | 現在のエントリーに関連するエントリーの数を確認し、合計を表示します。 |
| 合計 | 関連する各エントリーから数値を取得し、合計を計算します。       |
| 平均 | 関連する各エントリーから数値を取得し、平均を計算します。       |
| 最小 | 各関連エントリーから数値を取得し、最小値を計算します。        |
| 最大 | 各関連エントリーから数値を取得し、最大値を計算します。        |

![集計フィールドでは、回数、合計、平均、最小、最大の各関数を使用できます。](./aggregation-fields/images/01.png)

保険証券と保険金請求という2つの保険オブジェクトがあるシナリオを考えてみましょう。 保険証券オブジェクトと保険請求オブジェクトを一対多の関係で関連付ける場合、これらの集約フィールドをポリシーオブジェクトに追加することができます。

* 回数：各保険証券に関連する請求件数をカウントします。
* 合計：各保険証券に関連する保険請求の合計金額を計算し表示します。
* 平均：各保険証券に関連する保険請求の平均金額を計算し表示します。
* 最小：各保険証券の最低額の請求を特定し、表示します。
* 最大：各保険証券の最高額の請求を特定し、表示します。

## 集約フィルターの使用

1. 集約フィールドの編集を開始します。

1. フィルタ]の下にある[**追加**(![Add Button](../../../../images/icon-add.png))をクリックします。

1. 絞り込むフィールドを選択します。 利用可能なオプションは、関連オブジェクトの日付、整数、および候補リストフィールドです。

1. ［**Filter Type**］ を選択し、選択したフィールドをどのようにフィルターが使用するかを決定します。 選択できるオプションは、選択したフィールドによって異なります。

   日付フィールドについては、 ［**Range**］ を選択し、開始日と終了日を入力してください。

   候補リストフィールドについては、 ［**除外**］ または ［**Include**］ を選択し、必要な候補リスト値をチェックします。

   整数フィールドの場合は、 ［**と等しい**］ または ［**等しくない**］ を選択し、整数を入力します。

1. ［**Save**］ をクリックします。

   ![フィールドとフィルターのタイプを選択します。](./aggregation-fields/images/02.png)

1. (オプション) 複数のフィルターを集約フィールドに追加する場合は、この手順を繰り返してください。

   ![集計フィールドに複数のフィルターを追加します。](./aggregation-fields/images/03.png)

1. 完了したら、 ［**Save**］ をクリックします。

保存されると、すべてのフィルター基準を満たす関連エントリーのみが集計フィールドの計算に含まれます。

## 関連トピック

* [フィールド](../fields.md)
* [添付ファイルフィールド](./attachment-fields.md)
* [オブジェクトへのフィールドの追加](./adding-fields-to-objects.md)
