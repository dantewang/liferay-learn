# エクスプレッションビルダーバリデーションのリファレンス

{bdg-secondary}`Liferay 7.4 U27以降とGA27以降で利用可能`

カスタムオブジェクトでは、Liferayのエクスプレッションビルダーを使用してフィールドのバリデーションを作成できます。 このツールには、定義済みのフィールド、演算子、関数を使用して複雑なバリデーションルールを迅速に定義するための統合エディターがあります。 利用可能なエレメントは、条件サイドパネルで閲覧できます。

```{important}
エクスプレッションビルダーバリデーションは、テキスト、数値、日付、ブール値の各フィールドタイプでのみ使用可能です。
```

## テキスト項目

Liferayは、テキストおよび長いテキストフィールドに対して以下の演算子および関数を提供します。 これらのフィールドのいずれかを引数として使用できます。 いくつかの要素では、フィールドの値と比較するためのString値を追加することもできます（例： `"foo"`、`"[A-Za-z]{1,50}"`）。

### 連結

複数の文字列またはテキストフィールドを結合して、他の検証関数で使用できる単一の文字列を返します。

```
concat(<textField>, "<string>")
```

### 条件(テキスト付き)

ユーザー入力が一つ以上の条件を満たしているかどうかを調べ、ブール値を返す。この関数は `if` 文のように動作します。各式は少なくとも一つの `<condition>` (例: `<textField> == "foo"`) を含み、 `true` または `false` を返します。同じ式に複数の条件を追加して、どの条件にも当てはまらない場合に戻り値を決定することもできます（例： `<textField> == "foo", <textField> == "bar", true, false` ）。

```
condition(<condition>, <return-value>)
```

### が以下を含む（テキスト付き）

テキストフィールドが特定のString値を含んでいるかどうかを確認し、ブール値を返します。フィールドが値を **含まない** 場合は、`false`を返します。

```
contains(<textField>, "<string>")
```

### が以下を含まない（テキスト付き）

テキストフィールドが特定のString値を含んでいるかどうかを確認し、ブール値を返します。フィールドが値を **含む** 場合は、 `false`を返します。

```
NOT(contains(<textField>, "<string>"))
```

### URLである

テキストフィールドがURLであるかどうかを確認し、ブール値を返します。フィールドがURLパターンにマッチしない場合は、`false`を返します。`true`を返すには、エントリに標準的なURL要素（例: `http`, `://`, `.com`）を使用しなければなりません。

```
isURL(<textField>)
```

### メールアドレスである

テキストフィールドがメールアドレスであるかどうかを確認し、ブール値を返します。フィールドが特定のメールアドレスまたはメールアドレスパターンに一致しない場合、 `false`を返します。`true`を返すには、エントリーに標準的なメールアドレス要素（例: `@gmail`, `.com`）を使用する必要があります。

```
isEmailAddress(<textField>)
```

### が空の場合

テキストフィールドが空であるかどうかを確認し、ブール値を返します。フィールドが空ではない場合、`false`を返します。

```
isEmpty(<textField>)
```

### が以下と等しい（テキスト付き）

テキストフィールドが特定のString値に等しいかどうかを確認し、ブール値を返します。これが以下と **等しくない** 場合、`false`を返します。

```
<textField> == "<string>"
```

### が以下と等しくない（テキスト付き）

テキストフィールドが特定のString値と異なるかどうかを確認し、ブール値を返します。これが以下と **等しい** 場合、`false`を返します。

```
<textField> != "<string>"
```

### 一致

テキストフィールドが特定のString値または正規表現と一致するかどうかを確認し、ブール値を返します。フィールドが値と一致しない場合、`false`を返します。

```
match(<textField>, "<string>")

match(<textField>, "<regex>")
```

## 数値フィールド

Liferayでは、整数、長整数、小数、小数の精度フィールドに対して以下の演算子や関数を提供します。 これらのフィールドのいずれかを引数として使用できます。 いくつかの要素では、フィールドの値と比較するための数値を追加することもできます（例：`123`、 `3.1415`）。

### 条件（数値あり）

ユーザー入力が一つ以上の条件を満たしているかどうかを確認し、ブール値を返します。この関数は `if` 文のように動作します。各式は少なくとも一つの `<condition>` （例: `<numericField> == 10`）を含み、 `true`または`false`を返します。同じ式に複数の条件を追加して、どの条件も満たさない場合に戻り値を決定することができます（例：`<numericField> == 10, <numericField> != 100, true, false`）。

```
condition(<condition>, <return-value>)
```

###が以下を含む（数値あり）

数値フィールドが特定の数値を含んでいるかどうかを確認し、ブール値を返します。フィールドが値を **含まない** 場合、`false`を返します。

```
contains(<numericField>, <number>)
```

### が以下を含まない（数値あり）

数値フィールドが特定の数値を含んでいるかどうかを確認し、ブール値を返します。フィールドが値を **含む** 場合、`false`を返します。

```
NOT(contains(<numericField>, <number>))
```

### 小数である

数値フィールドが小数であるかどうかを確認し、ブール値を返します。フィールドが小数 **でない** 場合、`false`を返します。

```
isDecimal(<numericField>)
```

### 整数である

数値フィールドが整数であるかどうかを確認し、ブール値を返します。フィールドが整数 **でない** 場合、`false`を返します。

```
isInteger(<numericField>)
```

### が以下と等しい（数値あり）

数値フィールドが特定の数値に等しいかどうかを確認し、ブール値を返します。これらが **等しくない** 場合、`false`を返します。

```
<numericField> == <number>
```

### が以下と等しくない（数値あり）

数値フィールドが特定の数値と異なるかどうかを確認し、ブール値を返します。これらが **等しい** 場合、`false`を返します。

```
<numericField> != <number>
```

### 以上

数値フィールドが特定の数値より大きいかどうかを確認し、ブール値を返します。そのフィールドが特定の数値より **大きくない** 場合、`false`を返します。

```
<numericField> > <number>
```

### 以上もしくは等しい

数値フィールドが特定の数値以上もしくは等しいかどうかを確認し、ブール値を返します。フィールドが **等しくないか大きい** 場合は、 `false` を返します。
```
<numericField> >= <number>
```

### 以下

数値フィールドが特定の数値以下かどうかを確認し、ブール値を返します。フィールドが特定の数値 **以下ではない** 場合は、 `false`を返します。

```
<numericField> < <number>
```

### 以下もしくは等しい

数値フィールドが特定の数値以下もしくは等しいかどうかを確認し、ブール値を返します。フィールドが **等しくないか以下** の場合は、`false` を返します。

```
<numericField> <= <number>
```

### 合計

複数の数値フィールドをまとめて追加し、他の検証関数で使用可能な単一の数値を返します。

```
sum(<numericField>, <numericField>)
```

## 日付フィールド

Liferayは、日付フィールドに対して以下の演算子および関数を提供します。 任意の日付フィールドを引数として使用できます。 また、日付フィールドと比較するための日付値を設定できます（例： `2020-03-19`）。

### 日付を比較

日付フィールドの値が設定された値と同じかどうかを確認します。フィールドが日付と一致しない場合、`false`を返します。

```
compareDates(<dateField>, <yyyy-MM-dd>)
```

### 条件（日付あり）

ユーザー入力が一つ以上の条件を満たしているかどうかを確認し、ブール値を返します。この関数は`if`文のように動作します。各式は少なくとも一つの `<condition>` (例: `<dateField> == 2020-01-01`) を含み、`true`または`false`を返します。同じ式に複数の条件を追加して、どの条件にも当てはまらない場合に戻り値を決定することができます (例: `<dateField> == 2020-01-01, <dateField> != 2022-01-01, true, false`)。

```
condition(<condition>, <return-value>)
```

### 未来の日付

日付フィールドの値が将来かどうかを確認し、ブール値をします。 そのフィールドが将来の日付 **でない** 場合は、`false`を返します。

```
futureDates(<dateField>, "<yyyy-MM-dd>")
```

### 過去の日付

日付フィールドの値が過去かどうかを確認し、ブール値をします。 そのフィールドが過去の日付 **でない** 場合は、`false`を返します。

```
pastDates(<dateField>, "<yyyy-MM-dd>")
```

### 範囲

日付の範囲が過去の日付で始まり、未来の日付で終わるかどうかを確認します。フィールドがその日付の範囲内 **ではない** 場合、`false`を返します。

```
pastDates(<dateField>, "<yyyy-MM-dd>")
AND
futureDates(<dateField>, "<yyyy-MM-dd>")
```

## 数学演算子

数値フィールドには、以下のいずれの数学演算子も使用できます。

### プラス（`+`）

複数の数値フィールドを加算して式を作成します。

```
<numericField> + <numericField>
```

### マイナス（`-`）

複数の数値フィールドをお互いに減算して式を作成します。

```
<numericField> - <numericField>
```

### Divided By ( `/` )

ある数値フィールドを別の数値フィールドで除算して式を作成します。

```
<numericField> / <numericField>
```

### Multiply ( `*` )

複数の数値フィールドを乗算して式を作成します。

```
<numericField> * <numericField>
```

## 論理演算子

論理演算子は複数の要素で使用し、複数の要素から複雑な条件を集計します。 現在、エクスプレッションビルダーの検証は `AND` と `OR` の演算子を提供しています。

* `AND`：これは依存する関係を表すのによく使用される等位接続詞の一種です。

* `OR`：これは独立した関係を表す別タイプの等位接続詞です。

次の例では、 `AND`節は互いに依存しているので、一緒に適用される必要があります。 これに対し、 `OR` 節は論理的に分離されており、相互に依存していません。

```
match(<phoneNumberField>, "^([1-9]{2}) (?:[2-8]|9[1-9])[0-9]{3}-[0-9]{4}$")
AND match(<nameField>, "[A-Za-z]{1,50}")
AND match(<addressField>, "[A-Za-z]{1,50}")
OR <numericField> == 1
OR match(<lastNameField>, "[A-Za-z]{1,50}")
```

## バリデーション例

以下のバリデーションは一般的な例です。

### 名前のバリデーション（テキスト付き）

このバリデーションでは、値をアルファベット文字に限定し、許容される文字数が制限されます。

```
match(<nameField>, ("[A-Za-z]{1,50}")
```

このバリデーションでは、姓に数字を含めることができます。

```
match(<lastNameField>, "[A-Za-z][0-9]{1,50}")
```

### パスワード（テキスト付き）

このバリデーションでは、エントリーが以下のパスワードの条件を満たしているかどうかを確認します。

* 8文字以上
* 一意の5文字以上
* 1記号以上
* 1つ以上の数値
* スペースなし

```
match(<passwordField>, "^(?=.*[A-Za-z])(?=.*d)(?=.*[@$!%*#?&])[A-Za-zd@$!%*#?&]{8,}$")
```

### Cell Phone Number (with Numeric)

このバリデーションは、エントリーが電話番号のパターンに一致するかどうかを確認します。バリデーションはエントリーを数字に限定し、文字数も制限し、標準的な電話番号のパターンを設定します。

```
match(<phoneNumberField>, "^([1-9]{2}) (?:[2-8]|9[1-9])[0-9]{3}-[0-9]{4}$")
```

### 郵便番号（数値あり）

このバリデーションは、エントリーが郵便番号のパターンに一致するかどうかを確認します。バリデーションはエントリーを数字に限定し、文字数も制限し、標準的な郵便番号のパターンを設定します。

```
match(<postalField>, "^([1-9]{2}) (?:[2-8]|9[1-9])[0-9]{3}-[0-9]{4}$")
```

### 年齢幅の指定（日付）

このバリデーションでは、エントリーが18歳～65歳であるかどうかを確認します。

```
pastDates(<dateField>, startsFrom, responseDate, years, -120, endsOn, responseDate, years, -18)
AND
futureDates(<dateField>, startsFrom, responseDate, years, 0, endsOn, responseDate, years, 65)
```

## 追加情報

* [オブジェクトの作成](./creating-objects.md)
* [オブジェクトへのフィールドの追加](./adding-fields-to-objects.md)
* [カスタムバリデーションの追加](./adding-custom-validations.md)
