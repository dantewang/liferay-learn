# オブジェクトレイアウトの設計

{bdg-secondary}`Liferay DXP/Portal 7.4以降で利用可能`

オブジェクトレイアウトは、エントリーを作成または編集するときに、そのフィールドと関連がどのように編成および表示されるかを定義します。 デフォルトでは、オブジェクトポートレットで作成されたアプリケーションは、エントリーに自動生成されたレイアウトを使用します。 このレイアウトには、すべてのオブジェクトフィールドをアルファベット順に表示する単一のタブがあります。 ただし、カスタムレイアウトを設計して、要素を表示する方法と場所を決定できます。

```{important}
自動生成されたレイアウトには、オブジェクトリレーションは表示されません。 リレーションシップを表示するには、専用のリレーションシップタブを使用してカスタムレイアウトを作成する必要があります。
```

```{note}
カスタムレイアウトは、カスタムオブジェクトにのみ追加できます。 システムオブジェクトに追加することはできません。
```

## オブジェクトエントリレイアウトの追加

1. *オブジェクト*ポートレットを開き、目的の*オブジェクト*をクリックします。

1. *［Layouts］*タブをクリックし、*追加*ボタン（![Add Button](../../../images/icon-add.png)）を選択します。

   ![［Layouts］タブの追加ボタンをクリックし、新しいレイアウトの名前を入力して、［保存］をクリックします。](./designing-object-layouts/images/01.png)

1. *名前*を入力し、 *［Save］*をクリックします。

保存すると、新しい空白のレイアウトが作成されます。 これで、カスタムレイアウトに[タブを追加](#adding-layout-tabs)し、エントリーの作成と編集のためにオブジェクトのフィールドとリレーションシップをどのように編成するかを決定できます。

## レイアウトタブの追加
<!--TASK: Add drag and drop details once implemented.-->
オブジェクト要素は、次の2種類のタブに整理できます。

[**フィールド**](#fields-tabs)：オブジェクトエントリーフィールドを表示します。 これには、オブジェクトで直接作成されたフィールド、または*一対多*のリレーションシップから継承されたフィールドが含まれます。 <!--TASK: Add in One to One after implemented-->

[**リレーションシップ**](#relationships-tabs)：リレーションシップテーブルを表示し、*一対多*のリレーションシップの親側と*多対多*のリレーションシップの両側を表示するために使用する必要があります。

レイアウトを設計するには、必要なすべての[フィールド](#fields-tabs)と[リレーションシップ](#relationships-tabs)を追加するまで、次の手順を繰り返します。

```{important}
オブジェクトエントリーの作成中は、最初のタブのみが表示されます。 他のタブは、オブジェクトエントリーを編集するときにのみ表示されます。

また、レイアウトの最初のタブにリレーションシップを含めることはできません。また、［リレーションシップ］タブは、［フィールド］タブが設定された後でのみレイアウトに追加できます。
```

### フィールドタブ

1. 目的のレイアウトをクリックして、*［レイアウト］*タブに移動します。

   ![［レイアウト］タブには、レイアウトを作成するためのコントロールが含まれています。](./designing-object-layouts/images/02.png)

1. *Add Tab*をクリックし、 *Label*を入力し、 *Fields* type を選択し、 *Save*をクリックします。

   ラベルの値によって、Liferay UIでのタブの表示名が決定します。

   ![Add Tabをクリックし、Labelを入力し、Fields typeを選択し、Saveをクリックします。](./designing-object-layouts/images/03.png)

1. *ブロックの追加*をクリックし、 *ラベル*を入力し、 *保存*をクリックします。

   これにより、フィールドを追加できるタブサブセクションが作成されます。 ラベルの値によって、Liferay UIでのブロックの表示名が決定します。

   ```{note}
   フィールドをタブに直接追加することはできず、ブロックにまとめておく必要があります。
   ```

   ![ブロックの追加]をクリックし、[ラベル]を入力し、[保存]をクリックします。](./designing-object-layouts/images/04.png)

1. *Add Field*をクリックし、目的のフィールドを選択し、フィールドを1列、2列、または3列で表示するかどうかを決定し、 *Save*をクリックします。

   ```{note}
   フィールドは、レイアウトで1回だけ使用できます。
   ```

   ![フィールドの追加」をクリックし、フィールドを選択し、フィールドが表示される列の数を選択し、「保存」をクリックします。](./designing-object-layouts/images/05.png)

1. *［フィールドを追加］*をクリックしてさらにフィールドをブロックに追加するか、*［Add Block］*をクリックして追加するフィールド用に新しいブロックをタブに追加します。

1. トグルスイッチを使用して、ブロックが*折りたたみ可能*かどうかを決定します。

   ![トグルスイッチを使用して、ブロックが折りたたみ可能かどうかを決定します。](./designing-object-layouts/images/06.png)

1. *［保存］* をクリックします。

### リレーションシップタブ

1. 目的のレイアウトを選択して、*［Layout］*タブに移動します。

   ![希望のレイアウトを選択し、レイアウトタブを表示します。](./designing-object-layouts/images/07.png)

1. *追加タブ* をクリックし、 *ラベル*を入力します。 この値によって、Liferay UIでのタブの表示名が決定します。

1. タブタイプは、 *Relationship*を選択します。

1. タブに表示させたいリレーションシップを選択します。 1つのタブに表示できるリレーションシップは1つだけです。

   ```{note}
   レイアウトに少なくとも1つの［フィールド］タブがある場合にのみ、［リレーションシップ］タイプを選択できます。 エントリーの作成時にリレーションシップを設定することができないため、リレーションシップタブをオブジェクトレイアウトの最初のタブにすることはできません。 エントリは、他のオブジェクトエントリに関連付ける前に、まず存在しなければならない。
   ```

   ![タブのタイプとして［関連］を選択し、［One to Many］または［Many to Many］を選択して、関連テーブルを決定します。](./designing-object-layouts/images/08.png)

1. *［保存］*をクリックします。

```{important}
オブジェクトが自分自身と*Many to Many*の関係を持っている場合、そのレイアウトに2つのRelationshipタブを追加することができます。 各タブは、関係の片側に対応しています。 例えば、複数のチケットを互いに関連付けるチケットオブジェクトを考えてみましょう。 チケットとその依存関係を追跡するために、2つのリレーションシップタブを定義することができます。 1 つのタブは、現在のチケットが依存しているすべてのチケットをリストアップし、もう 1 つのタブは、現在のチケットに依存しているすべてのチケットをリストアップします。 リレーションシップの詳細については、[オブジェクトリレーションシップの定義](./defining-object-relationships.md)を参照してください。
```

## カテゴリー分けの追加

{bdg-secondary}`利用可能な Liferay 7.4 U31+ および GA31+`

必要に応じて、 *Categorization* ブロックを [*Fields* tabs](#fields-tabs)に追加することができます。 エンドユーザーは、オブジェクトのエントリに適用できるタグやカテゴリにアクセスできるようになります。

```{note}
VisibilityとPermissionは、Categorizationブロックの表示方法に影響を与えます。
```

以下の手順で、「フィールド」タブに「カテゴリー」ブロックを追加してください。

1. 目的のレイアウトを選択して、*［Layout］*タブに移動します。

1. 目的の *アクション* ボタン (![Actions Button](../../../images/icon-actions.png)) をクリックし、 [*フィールド* タブ](#fields-tabs) を選択し、 *カテゴリの追加*を選択します。

   ![アクション]ボタンをクリックし、[カテゴリの追加]を選択します。](./designing-object-layouts/images/09.png)

   これにより、カテゴリ分けツールにアクセスするためのタブに新しいブロックが追加されます。

   ```{important}
   Categorizationブロックは、1レイアウトにつき1つのタブにしか追加できません。
   ```

1. ブロックが *折り畳み式かどうかを判断する*.

   ![Categorizationブロックが折りたたみ可能かどうかを判断します。](./designing-object-layouts/images/10.png)

1. *［Save］* をクリックします。

オブジェクトのエントリーを作成または編集する際に、ユーザーはタグやカテゴリーにアクセスし、適用することができるようになりました。

![タグやカテゴリーにアクセスし、オブジェクトのエントリに適用することができます。](./designing-object-layouts/images/11.png)

## デフォルトのレイアウトの選択

目的のフィールドとリレーションシップをカスタムレイアウトに追加したら、それをオブジェクトのデフォルトレイアウトとして設定できます。 これにより、オブジェクトのエントリーの作成と編集に確実に使用されるようになります。 デフォルトとしてカスタムレイアウトが選択されていない場合、オブジェクトは自動的に生成されたレイアウトを使用します。

```{important}
デフォルトとしてカスタムレイアウトを選択するには、必要なすべてのオブジェクトフィールドをレイアウトの最初のタブに追加する必要があります。
```

次の手順に従って、オブジェクトのデフォルトのレイアウトを選択します。

1. 希望のレイアウトを選択する。

1. 基本詳細」タブで、 *「既定値としてマークする」*をチェックします。

   ![デフォルトとしてマークをチェックし、[保存]をクリックします。](./designing-object-layouts/images/12.png)

1. *［Save］* をクリックします。

オブジェクトのエントリーを作成および編集するときに、レイアウトが使用されるようになりました。

## 追加情報

* [オブジェクトの作成](./creating-objects.md)
* [オブジェクトへのフィールドの追加](./adding-fields-to-objects.md)
* [オブジェクトリレーションの定義](./defining-object-relationships.md)
* [オブジェクトの管理](./managing-objects.md)
