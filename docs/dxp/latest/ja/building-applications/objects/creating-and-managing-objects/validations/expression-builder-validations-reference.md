# エクスプレッションビルダー検証のリファレンス

{bdg-secondary}`Liferay 7.4 U67+/GA67+`.

カスタムオブジェクトでは、Liferayのエクスプレッションビルダーを使用してフィールドの検証を作成できます。 このツールには、定義済みのフィールド、演算子、関数を使用して複雑な検証ルールを迅速に定義するための統合エディターがあります。 利用可能な要素は、条件サイドパネルで閲覧できます。

```{important}
式ビルダーの検証は、テキスト、数値、日付、およびブール値のフィールド・タイプでのみ使用できます。
```

## テキストフィールド

Liferayは、テキストおよび長いテキストフィールドに対して以下の演算子および関数を提供します。 これらのフィールドのいずれかを引数として使用できます。 いくつかの要素では、フィールドの値と比較する文字列値を追加することもできます（例：`"foo"`、`"[A-Za-z]{1,50}"`）。

### 連結

複数の文字列またはテキストフィールドを結合し、他の検証関数で使用可能な単一の文字列を返します。

```
concat([textField], "[string]")
```

### 条件（テキストあり）

ユーザー入力が1つ以上の条件を満たすかどうかをチェックし、ブール値を返します。 この関数は`if`文のように動作する。 各式は少なくとも一つの `条件`（例えば `textFieldName == "foo"`）を含み、`true` または `false` を返す。 同じ式に複数の条件を追加し、どの条件も満たさない場合に戻り値を決定することができる（例：`textFieldName=="foo", textFieldName=="bar",true,false`）。

```
condition([condition], [return-value])
```

### が以下を含む（テキストあり）

テキストフィールドが特定のString値を含んでいるかどうかを確認し、ブール値を返します。 フィールドに値が **ない** 場合は `false` を返す。

```
contains([textField], "[string]")
```

### 含まない（テキストあり）

テキストフィールドに特定の文字列値が含まれていないかどうかを調べ、ブール値を返します。 フィールドに **値が** あれば、`false`を返す。

```
NOT(contains([textField], "[string]"))
```

### URL である

テキストフィールドがURLであるかどうかを確認し、ブール値を返します。 フィールドがURLパターンにマッチしない場合、`false`を返す。 true`を返すには、エントリーに標準的なURL要素（例：`http`、`://`、`.com`）を使用しなければならない。

```
isURL([textField])
```

### メールアドレスである

テキストフィールドがメールアドレスであるかどうかを確認し、ブール値を返します。 フィールドが特定のEメールまたはEメールパターンにマッチしない場合、`false`を返す。 true`を返すには、エントリーに標準的なemail要素（例：@gmail`、`.com`）を使用する必要があります。

```
isEmailAddress([textField])
```

### が空の場合

テキストフィールドが空であるかどうかを確認し、ブール値を返します。  フィールドが空でなければ `false` を返す。

```
isEmpty([textField])
```

### と等しい（テキストあり）

テキストフィールドが特定のString値に等しいかどうかを確認し、ブール値を返します。 等しくなければ `false` を返す。

```
[textField] == "[string]"
```

### 等しくない （テキストあり）

テキストフィールドが特定のString値と異なるかどうかを確認し、ブール値を返します。 等しい場合は `false` を返す。

```
[textField] != "[string]"
```

### 一致

テキストフィールドが特定のString値または正規表現と一致するかどうかを確認し、ブール値を返します。 フィールドが値と一致しない場合は `false` を返す。

```
match([textField], "[string]")

match([textField], "[regex]")
```

### 古い値（テキスト付き）

指定したテキストフィールドの事前値を取得します。 この値は、他の関数や演算子で使用することができます。

```
oldValue([textFieldName])
```

## 数値フィールド

Liferayでは、整数、長整数、小数、小数の精度フィールドに対して以下の演算子や関数を提供します。 これらのフィールドのいずれかを引数として使用できます。 いくつかの要素では、フィールドの値と比較するために数値を追加することもできます（例：`123`、`3.1415`）。

### 条件（数値あり）

ユーザー入力が1つ以上の条件を満たすかどうかをチェックし、ブール値を返します。 この関数は`if`文のように動作する。 各式は少なくとも一つの `条件`（例えば `numericFieldName == 10`）を含み、`true` または `false` を返す。 同じ式に複数の条件を追加し、どの条件も満たさない場合に戻り値を決定することができる（例：`numericFieldName == 10, numericFieldName != 100, true, false`）。

```
condition([condition], [return-value])
```

### が以下を含む（数値あり）

数値フィールドが特定の数値を含んでいるかどうかを確認し、ブール値を返します。 フィールドに値が **ない** 場合は `false` を返す。

```
contains([numericField], [number])
```

### 含まない（数値あり）

数値フィールドが特定の数値を含んでいるかどうかを確認し、ブール値を返します。 フィールドに **値が** あれば、`false`を返す。

```
NOT(contains([numericField], [number]))
```

### 小数である

数値フィールドが小数であるかどうかを確認し、ブール値を返します。 フィールドが **10進数でない** 場合、`false`を返す。

```
isDecimal([numericField])
```

### 整数である

数値フィールドが整数であるかどうかを確認し、ブール値を返します。 フィールドが **整数でない** 場合、`false`を返す。

```
isInteger([numericField])
```

### と等しい（数値あり）

数値フィールドが特定の数値に等しいかどうかを確認し、ブール値を返します。 等しくなければ `false` を返す。

```
[numericField] == [number]
```

### 等しくない （数値あり）

数値フィールドが特定の数値と異なるかどうかを確認し、ブール値を返します。 等しい場合は `false` を返す。

```
[numericField] != [number]
```

### 以上

数値フィールドが特定の数値より大きいかどうかを確認し、ブール値を返します。 もしフィールドが **大きくない** なら、`false`を返す。

```
[numericField] > [number]
```

### 以上もしくは等しい

数値フィールドが特定の数値以上もしくは等しいかどうかを確認し、ブール値を返します。 フィールドが等しいかそれ以上でない場合は `false` を返す。

```
[numericField] >= [number]
```

### 以下

数値フィールドが特定の数値以下かどうかを確認し、ブール値を返します。 もしフィールドが **小さくない** なら、`false`を返す。

```
[numericField] < [number]
```

### 以下もしくは等しい

数値フィールドが特定の数値以下もしくは等しいかどうかを確認し、ブール値を返します。 もしフィールドが等しくないか、または小さい場合は `false` を返す。

```
[numericField] <= [number]
```

### 古い値（数値入り）

指定した数値フィールドの事前値を取得します。 この値は、他の関数や演算子で使用することができます。

```
oldValue([numericField])
```

### 合計

複数の数値フィールドをまとめて追加し、他の検証関数で使用可能な単一の数値を返します。

```
sum([numericField], [numericField])
```

## 日付フィールド

Liferayは、日付フィールドに対して以下の演算子および関数を提供します。 任意の日付フィールドを引数またはパラメータとして使用できます。 さらに、日付フィールド（例：`2020-03-19`）と比較するために、固定の日付値（`"yyyy-MM-dd"`）を入力することができます。

### 日付を比較

日付フィールドの値がパラメータと同じかどうかを調べます。 フィールドがパラメータと一致しない場合は `false` を返す。

```
compareDates([dateField], [parameter])
```

### 条件（日付あり）

ユーザー入力が1つ以上の条件を満たすかどうかをチェックし、ブール値を返します。 この関数は`if`文のように動作する。 各式は少なくとも一つの `条件` (例えば `dateFieldName == 2020-01-01`) を含み、`true` または `false` を返す。 同じ式に複数の条件を追加し、どの条件も満たさない場合に戻り値を決定することができる（例：`dateFieldName == 2020-01-01, dateFieldName != 2022-01-01, true, false`）。 <!--TASK: Update Example-->

```
condition([condition], [return-value])
```

### 未来の日付

日付フィールドの値が、設定されたパラメータと等しいか、またはそれ以降であるかどうかを調べます。 もしそうでなければ、この関数は `false` を返す。

```
futureDates([dateField], [parameter])
```

例えば、

```
futureDates(endDate, startDate)
```

```
futureDates(endDate, "2024-01-01")
```

最初の例では、`endDate` が `startDate` の値と等しいか、それ以降であるかをチェックしている。 つ目の例は、`endDate`の値が`2024-01-01`以降かどうかをチェックする。

### 古い値（日付入り）

指定された日付フィールドの前の値を取得します。 この値は、他の関数や演算子で使用することができます。

```
oldValue([dateField])
```

### 過去の日付

日付フィールドの値が、設定されたパラメータと等しいかそれ以前であるかどうかを調べます。 もしそうでなければ、この関数は `false` を返す。

```
pastDates([dateField], [parameter])
```

例えば、

```
pastDates(startDate, endDate)
```

```
pastDates(startDate, "2024-01-01")
```

最初の例では、`startDate`が`endDate`の値と等しいか、それより前にあるかどうかをチェックしている。 2つ目は、`startDate`の値が`2024-01-01`以前かどうかをチェックする。

### 範囲

日付フィールドの値が過去の日付で始まり、未来の日付で終わるかどうかをチェックする。 もし日付が範囲内に **ない** 場合、`false`を返す。

```
futureDates([dateField], [parameter])
AND
pastDates([dateField], [parameter])
```

例えば、

```
futureDates(endDate, startDate)
AND
pastDates(startDate, endDate)
```

これは、`endDate` の値が `startDate` の値と等しいか等しくないか、また `startDate` の値が `endDate` の値と等しいか等しくないかをチェックする。

## 数学演算子

数値フィールドには、以下のいずれの数学演算子も使用できます。

### プラス ( `+` )

複数の数値フィールドを加算して式を作成します。

```
[numericField] + [numericField]
```

### マイナス ( `-` )

複数の数値フィールドをお互いに減算して式を作成します。

```
[numericField] * [numericField]
```

### で割った ( `/` )

ある数値フィールドを別の数値フィールドで除算して式を作成します。

```
[numericField] / [numericField]
```

### 乗算 ( `*` )

複数の数値フィールドを乗算して式を作成します。

```
[numericField] * [numericField]
```

## 論理演算子

論理演算子は複数の要素で使用し、複数の要素から複雑な条件を集計します。 現在、エクスプレッションビルダーのバリデーションには `AND` 演算子と `OR` 演算子があります。

* `AND`：従属関係を示す。

* `OR`：独立した関係を示す。

以下の例では、`AND`節は互いに依存しているので、一緒にとらえなければならない。 対照的に、`OR`節は論理的に分離しており、互いに共依存ではない。

```
match([phoneNumberField], "^([1-9]{2}) (?:[2-8]|9[1-9])[0-9]{3}-[0-9]{4}$")
AND match([nameField], "[A-Za-z]{1,50}")
AND match([addressField], "[A-Za-z]{1,50}")
OR [numericField] == 1
OR match([lastNameField], "[A-Za-z]{1,50}")
```

## 検証例

以下の検証は一般的な例です。 これらを使用するには、`fieldName`を検証するフィールド名に置き換える。

### 名前の検証（テキストあり）

値をアルファベット文字に限定し、許容される文字数が制限されます。

```
match(fieldName, "[A-Za-z]{1,50}")
```

姓に数字を使用できます。

```
match(fieldName, "[A-Za-z][0-9]{1,50}")
```

### パスワード（テキストあり）

エントリーが以下のパスワード基準を満たしているかどうかをチェックします。

* 8文字以上
* 一意の5文字以上
* 1記号以上
* 1つ以上の数値
* スペースなし

```
match(fieldName, "^(?=.*[A-Za-z])(?=.*d)(?=.*[@$!%*#?&])[A-Za-zd@$!%*#?&]{8,}$")
```

### 携帯電話番号（数字あり）

エントリーが電話番号のパターンに一致するかどうかを確認します。 検証はエントリーを数字に限定し、文字数も制限し、標準的な電話番号のパターンを設定します。

```
match(fieldName, "^([1-9]{2}) (?:[2-8]|9[1-9])[0-9]{3}-[0-9]{4}$")
```

### 郵便番号（数値あり）

エントリーが郵便番号のパターンに一致するかどうか確認します。 検証はエントリーを数字に限定し、文字数も制限し、標準的な郵便番号のパターンを設定します。

```
match(fieldName, "^([1-9]{2}) (?:[2-8]|9[1-9])[0-9]{3}-[0-9]{4}$")
```

### 年齢幅の指定（日付）

エントリーが18歳以上65歳未満かどうかを確認します。

```
pastDates(fieldName, startsFrom, responseDate, years, -120, endsOn, responseDate, years, -18)
AND
futureDates(fieldName, startsFrom, responseDate, years, 0, endsOn, responseDate, years, 65)
```

## 関連トピック

* [オブジェクトの作成](../creating-objects.md)
* [オブジェクトへのフィールドの追加](../fields/adding-fields-to-objects.md)
* [カスタムバリデーションの追加](../validations/adding-field-validations.md)
