# オブジェクトリレーションの定義

{bdg-secondary}`Liferay DXP/Portal 7.4以降で利用可能`

リレーションシップは、オブジェクト定義間の接続であり、そのエンティティをリンクさせるために使用することができます。 システムオブジェクトとカスタムオブジェクトの両方を含む、任意のパブリッシュまたは非パブリッシュのオブジェクトにリレーションシップを追加することができます。

## リレーションシップの種類

オブジェクトには、次の2種類のリレーションシップがあります。

<!--TASK: Add One to One after it's been implemented-->

**1対多** ：現在のオブジェクトのエンティティの1つを別のオブジェクトの複数のエンティティに関連付けることができます。 選択すると、関連の子側（つまり、「多」側）のエンティティに新しいフィールドが追加され、「親」側（つまり、「1」側）にテーブルが追加されます。 子側では、新しいフィールドをオブジェクトのカスタムレイアウトの[フィールドタブ](./designing-object-layouts.md#adding-fields-tabs)に追加し、そのエンティティを関連の親側の単一エンティティに関連付けることができます。 親側では、新しいテーブルをオブジェクトのカスタムレイアウトの[関連タブ](./designing-object-layouts.md#adding-relationships-tabs)に追加して、現在の親エンティティに関連するすべてのエンティティを一覧表示できます。 <!--REFINE-->

**多対多** ：現在のオブジェクトの複数のエンティティを別のオブジェクトの複数のエンティティに関連付けることができます。 選択すると、リレーションシップの両側に新しいデータベーステーブルが作成されます。 このテーブルは、いずれかのオブジェクトのカスタムレイアウトの[リレーションシップタブ](./designing-object-layouts.md#adding-relationships-tabs)に追加でき、関連するすべてのエンティティを一覧表示するために使用されます。 <!--REFINE-->

```{important}
リレーションシップテーブルの表示には、カスタムレイアウトが必要です。 ただし、システムオブジェクトのカスタムレイアウトはサポートされていません。 詳しくは、[オブジェクトレイアウトの設計](./designing-object-layouts.md)を参照してください。 
```

## 新しいリレーションシップの追加

次の手順に従って、オブジェクトにリレーションシップを追加します。

1. **オブジェクト** ポートレットを開きます。

1. 目的のオブジェクトを選択します。

1. ［**リレーションシップ**］ タブをクリックし、 **追加** ボタン（![Add Button](../../../images/icon-add.png)）を選択します。

   ![［リレーションシップ］タブの追加ボタンをクリックし、ラベルと名前を入力して、リレーションシップタイプと目的のオブジェクトを選択します。](./defining-object-relationships/images/01.png)

1. **ラベル** と **リレーションシップ名** を入力します。

   **ラベル** ：オブジェクトUIでリレーションシップを識別し、リレーションシップの作成後にローカライズできます。

   **関連名** ：バックエンドで関連の名前を決定し、キャメルケースを使用します。 リレーションシップが公開されると、この値は変更できません。

1. リレーションシップの種類（［**一対多**］ または ［**多対多**］）を選択します。 <!--TASK: Add One to One after it's been implemented-->

   ```{note}
   同じオブジェクト内のエントリーを関連付けたい場合は、［一対多］タイプを使用する必要があります。 <!--タスク：実装後に1対1で追加-->
   ```

1. 現在のオブジェクトに関連付ける **オブジェクト** を選択します。

1. ［**保存**］ をクリックします。

   ![［保存］をクリックすると、保存された関連が［リレーションシップ］タブに一覧表示されます。](./defining-object-relationships/images/02.png)

保存すると、新しいリレーションシップを関連するオブジェクトの[カスタムレイアウトに追加](./designing-object-layouts.md)できます。 次に、リレーションシップフィールドとテーブルを使用して、オブジェクトエントリーを相互に関連付けることができます。

## 削除タイプの構成

リレーションシップが保存されたら、その削除タイプを構成できます。 この設定は、エントリーが別のエントリーに関連付けられている場合のエントリーの削除の処理方法を決定し、リレーションシップが作成された後にのみ使用できます。

![リレーションシップを作成した後、その削除タイプを構成できます。](./defining-object-relationships/images/03.png)

使用可能なオプションには、 ［**Prevent**］ 、 ［**Disassociate**］ 、および ［**Cascade**］ があります。

**Prevent**（デフォルト）：親側のエントリは、子エントリに関連している場合は削除できません。

**Disassociate** ：親側のエントリは、関連する子エントリに影響を与えることなく自由に削除できます。

**Cascade** ：親側のエントリは自由に削除できます。親エントリを削除すると、ユーザーが子オブジェクトに必要な権限を持っている場合、関連する子エントリもすべて削除されます。

## リレーションシップの削除

{bdg-secondary}`Liferay 7.4 U26以降およびGA26以降で利用可能`

ドラフトと公開されたオブジェクト定義の両方からリレーションシップを削除することができます。 リレーションシップを削除すると、関連するオブジェクト定義からそのフィールドが永久に削除されます。 公開された定義の場合、これは多くのレコードに影響を与える可能性があります。

```{important}
Liferay 7.4 U26/GA26 以前のバージョンでは、 [公開された](./creating-objects.md#publishing-object-drafts) 時点でオブジェクトに含まれているリレーションシップをユーザーが削除できないようになっています。
```

次の手順で、公開されているオブジェクト定義からリレーションシップを削除します。

1. **グローバルメニュー**（![Global Menu](../../../images/icon-applications-menu.png)）を開き、 ［**コントロールパネル**］ タブに移動して、 ［**オブジェクト**］ をクリックします。

1. 目的のオブジェクト定義の編集を開始し、 ［**リレーションシップ**］ タブに進みます。

1. 目的のリレーションシップの **アクション** ボタン (![Actions Button](../../../images/icon-actions.png))をクリックし、 ［**削除**］ を選択します。

1. ダイアログウィンドウで、リレーションシップの名前を入力し、 **Delete** をクリックして確認します。

   ![リレーションシップの名前を入力し、［Done］をクリックします。](./defining-object-relationships/images/04.png)

## 追加情報

* [オブジェクトの作成](./creating-objects.md)
* [オブジェクトへのフィールドの追加](./adding-fields-to-objects.md)
* [オブジェクトレイアウトの設計](./designing-object-layouts.md)
* [オブジェクトの管理](./managing-objects.md)
