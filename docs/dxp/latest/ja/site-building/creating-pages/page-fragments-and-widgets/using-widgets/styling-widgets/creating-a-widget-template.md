# ウィジェットテンプレートの作成

ウィジェットテンプレートは、 [FreeMarker](https://freemarker.apache.org/) 、サイトページ内でウィジェットがどのようにレンダリングされるかを決定します。 各テンプレートは、特定のウィジェットタイプ用に設計されており、ページ内のウィジェットを設定する際に選択することができます。

```{note}
Liferay DXP/Portal 7.4+では、ウィジェットテンプレートはFreeMarkerにのみ対応しています。 Velocityはサポート終了しました。
```

以下の手順でWidget Templateを作成します：

1. ウィジェットテンプレートを作成する目的のサイトに移動します。

1. **サイトメニュー** ( ![サイトメニュー](../../../../images/icon-product-menu.png) ) から、 **デザイン** &rarr; **テンプレート** &rarr; **ウィジェットテンプレート** にアクセスします。

   ```{note}
   グローバルサイトでは、ウィジェットテンプレートのサンプルを見ることができます。 これらのサンプルテンプレートは、すでにアプリに設定されているデフォルトのテンプレートとは異なります。
   ```

1. **追加**( ![Add Button](../../../../images/icon-add.png) ) をクリックし、作成するテンプレートの種類を選択します。

   ![デザインとウィジェットのテンプレートをクリックします。](./creating-a-widget-template/images/01.png)

1. テンプレートに **名** を入力します。

1. エディターでテンプレートをデザインします。

   **Elements** サイドパネル( ![Elements](../../../../images/icon-list-ul.png) )では、利用可能なウィジェットフィールド、変数、ユーティリティから選択することができます。 すべてのウィジェットに共通する要素もあれば、選択したウィジェットタイプに特化した要素もあります。

   ![フィールド要素を使用してテンプレートを設計します。](./creating-a-widget-template/images/02.png)

1. (オプション）詳細サイドパネル(![Details](../../../../images/icon-cog3.png) ）で、 **説明** を入力し、 **画像** をテンプレートのために選択します。

1. ［**Save**］ をクリックします。

## テンプレートエディター

テンプレートエディターの右側には、テンプレートの作成に使用する一般的な変数のパレットがあります。 テンプレートを作成する際の参考にしてください。 テンプレートエディターに変数を配置するには、配置したい場所にテキストカーソルを置き、変数名をクリックします。

また、各変数には、詳細な説明を表示するツールチップがあります。 ウィジェットテンプレートには複数の種類があるため、ウィジェットテンプレートごとに異なる変数も存在します。 したがって、各テンプレートには、その特定のテンプレートにのみ適用可能な異なる変数のセットがあります。

![Liferayは、ウィジェットテンプレートをカスタマイズするための多機能なスクリプトエディターを提供します。](./creating-a-widget-template/images/03.png)

また、オートコンプリート機能を使って、テンプレートに変数を追加することもできます。 **${** と入力すると、利用可能な変数のドロップダウンメニューが表示され、呼び出すことができます。 変数の一つをクリックすると、エディターにその変数が挿入されます。

また、同じ種類のテンプレートを他のテンプレートに埋め込むことも可能です。 例えば、既存のWikiウィジェットテンプレートがあり、別のWikiウィジェットテンプレートを作成したい場合を考えます。 ゼロから始めるのではなく、既存のWikiウィジェットテンプレートを新しいものにインポートして、それを元に構築することができます。 つまり、VelocityやFreeMarkerのテンプレートで取り込んだコードをシステムで再利用するための汎用テンプレートとして、ウィジェットテンプレートを利用することができるのです。

## ウィジェットテンプレートの設定

ウィジェットテンプレートを保存した後、そのアクションボタン(![Actions Button](../../../../images/icon-actions.png))で管理することができます。 これにはいくつかのオプションがあります。

- **Edit** : ウィジェットテンプレートの設定プロパティを変更します。
- **権限** : ウィジェットテンプレートの権限 **更新** 、 **権限** 、 **削除** 、 **表示** を管理します。
- **コピー** : ウィジェットテンプレートのコピーを作成します。
- **削除** : ウィジェットテンプレートを削除します。

さらに、ウィジェットテンプレートは、静的URLとWebDAV URLを生成します。 これらの値は、テンプレートのXMLソースにアクセスします。 これらのURLは、メニューからウィジェットテンプレートをクリックし、 **Details** セクションを展開することで見つけることができます。 WebDAV URLにより、サイト管理者はリモートサーバー上のウィジェットテンプレートを追加、参照、編集、削除することができます。 WebDAV URL でできることの詳細については、 [WebDAV アクセス](../../../../../content-authoring-and-management/documents-and-media/publishing-and-sharing/accessing-documents-with-webdav.md)を参照してください。

```{note}
ウィジェットテンプレートにウィジェットを埋め込むことは可能ですが、他のウィジェットとの競合や予期せぬ動作(例：パンくずリストへのデータ集計ウィジェットの埋め込み）を引き起こす可能性があるため、推奨されません。 ウィジェットテンプレートにウィジェットを埋め込むしかない場合、他のウィジェットと干渉しないことを確認してください。
```

次に、新しいウィジェットテンプレートを使用するようにウィジェットを設定します。

1. 修正したいウィジェットの ［**Configuration**］ ページを開き、 ［**表示設定**］ を開いてください。

1. ［**表示テンプレート**］ で、ドロップダウンメニューからウィジェットテンプレートを選択します。

また、アプリのサイト固有の表示テンプレートを管理することもできます。この場合は、**表示テンプレート** ドロップダウンメニューの隣にある **[SPECIFIC_SITE]の表示テンプレートを管理する** リンクをクリックします。ウィンドウが表示され、新しいテンプレートの追加や既存のテンプレートの編集が可能な、あなたのサイトでのみ利用可能な設定済みテンプレートのリストが表示されます。

![アプリの **設定** メニューをクリックすると、利用可能なウィジェットテンプレートを編集・管理できます。](./creating-a-widget-template/images/04.png)

## 追加情報

- [ウィジェットテンプレートの例](./using-a-widget-template-example.md)
