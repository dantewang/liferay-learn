# ウィジェットテンプレートの作成

Widget Templatesは、 [FreeMarker](https://freemarker.apache.org/) を使用して、サイトページでのウィジェットのレンダリング方法を決定します。 各テンプレートは、特定のウィジェットタイプのために設計されており、ページでウィジェットを設定する際に選択することができます。

```{note}
Liferay DXP/Portal 7.4+ では、Widget テンプレートは FreeMarker のみをサポートしています。 Velocityはサポートを終了しました。
```

以下の手順でウィジェットテンプレートを作成します。

1. ウィジェットテンプレートを作成したいサイトへ移動します。

1. サイトメニューを開く ![サイトメニュー](../../../../images/icon-product-menu.png) をクリックし、 *Design* &rarr; *Templates* &rarr; *Widget Templates*.

   ```{note}
   グローバルサイトでは、ウィジェットのサンプルテンプレートを見ることができます。 これらのサンプルテンプレートは、すでにアプリに設定されているデフォルトのテンプレートとは異なります。
   ```

1. *追加* ボタン(![Add Button](../../../../images/icon-add.png))をクリックし、作成するテンプレートの種類を選択します。

   ![デザインとウィジェットのテンプレートをクリックします。](./creating-a-widget-template/images/01.png)

1. </em> テンプレートの名前 *を入力します。</p></li>

1

エディターでテンプレートをデザインします。

   *Elements* サイドパネル(![Elements](../../../../images/icon-list-ul.png))で、利用可能なウィジェットフィールドから選択することができます。 すべてのウィジェットに共通するフィールドもあれば、選択したウィジェットタイプに固有のフィールドもあります。

   ![フィールド要素を用いてテンプレートを設計する。](./creating-a-widget-template/images/02.png)

1

(オプション) *詳細* サイドパネル (![Details](../../../../images/icon-cog3.png)) で、 *説明* を入力し、 *画像* をテンプレートのために選択します。

1

*［保存］* をクリックします。</ol>

## テンプレートエディター

テンプレートエディタの右側には、テンプレートの作成によく使われる変数がパレットで表示されています。 テンプレートを作成する際の参考にしてください。 テンプレートエディターに変数を配置するには、配置したい場所にテキストカーソルを置き、変数名をクリックします。

また、各変数には、詳細な説明を表示するツールチップがあります。 ウィジェットテンプレートには複数の種類があるため、ウィジェットテンプレートごとに異なる変数も存在します。 したがって、各テンプレートには、その特定のテンプレートにのみ適用可能な異なる変数のセットがあります。

![Liferayは、ウィジェットテンプレートをカスタマイズするための多機能なスクリプトエディターを提供します。](./creating-a-widget-template/images/03.png)

また、オートコンプリート機能を使って、テンプレートに変数を追加することもできます。 *${* と入力すると、利用可能な変数のドロップダウンメニューが表示され、呼び出すことができます。 変数の一つをクリックすると、エディターにその変数が挿入されます。

また、同じ種類のテンプレートを他のテンプレートに埋め込むことも可能です。 例えば、既存のWikiウィジェットテンプレートがあり、同様のWikiウィジェットテンプレートをもう1つ作成したいとします。 ゼロから始めるのではなく、既存のWikiウィジェットテンプレートを新しいものにインポートして、それを元に構築することができます。 つまり、システム内のVelocityやFreeMarkerのテンプレートから再利用可能なコードを取り込むことができる汎用テンプレートとして、ウィジェットテンプレートを活用することができます。

## ウィジェットテンプレートの設定

ウィジェットテンプレートを保存した後は、 *アクション* ボタン (![Actions Button](../../../../images/icon-actions.png)) から管理することが可能です。 これにはいくつかのオプションがあります。

- *編集*: ウィジェットテンプレートの設定プロパティを変更することができます。
- *権限設定*: ウィジェットテンプレートの *アップデート*、*権限設定*、*削除*、そして*表示* を管理することができます。
- *コピー*: ウィジェットテンプレートのコピーを作成します。
- *削除*: ウィジェットテンプレートを削除します。

さらに、ウィジェットテンプレートは、静的URLとWebDAV URLを生成します。 これらの値は、テンプレートのXMLソースにアクセスします。 これらのURLは、メニューからウィジェットテンプレートをクリックし、 *Details* セクションを展開することで見つけることができます。 WebDAV URLにより、サイト管理者はリモートサーバー上のウィジェットテンプレートを追加、参照、編集、削除することができます。 WebDAVのURLで何ができるかを詳しく知りたい方は、 [WebDAV access](../../../../content-authoring-and-management/documents-and-media/publishing-and-sharing/accessing-documents-with-webdav.md)の記事をご覧ください。

```{note}
ウィジェットテンプレートにウィジェットを埋め込むことは可能ですが、他のウィジェットとの競合や予期せぬ動作（例：パンくずリストへのデータ集計ウィジェットの埋め込み）を引き起こす可能性があるため、推奨されません。 ウィジェットテンプレートにウィジェットを埋め込むしかない場合、他のウィジェットと干渉しないことを確認してください。
```

次に、新しいウィジェットテンプレートを使用するようにウィジェットを設定します。

1. 修正したいウィジェットの *［Configuration］* ページを開き、 *［表示設定］*を開いてください。

1. *［表示テンプレート］*で、ドロップダウンメニューからウィジェットテンプレートを選択します。

また、アプリのサイト固有の表示テンプレートも管理できます。これを行うには、*表示テンプレート*の横の*Manage Display Templates for [SPECIFIC_SITE]*をクリックしてください。 設定されたテンプレートのリストが表示され、新しいテンプレートを追加したり、既存のテンプレートを編集したりすることができます。

![アプリの*設定*メニューをクリックすると、利用可能なウィジェットテンプレートを編集・管理することができます。](./creating-a-widget-template/images/04.png)

## 追加情報

- [ウィジェットテンプレートの例](./using-a-widget-template-example.md)