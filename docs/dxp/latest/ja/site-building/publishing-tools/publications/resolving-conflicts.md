# 競合の解決

公開プロセスを開始すると、Liferayは互換性チェックを実行して、パブリケーションと本番環境の間に競合があるかどうかを判断します。 一部の競合は自動的に解決されますが、その他の競合は手動で解決する必要があります。 変更を公開するには、すべての競合を解決する必要があります。

[$LIFERAY_LEARN_YOUTUBE_URL$]=https://www.youtube.com/embed/4w16zEFoP8o

```{note}
公開時の競合は、パブリケーションに変更が加えられた*後に*本番環境に変更が加えられた場合にのみ発生します。 これは、各パブリケーションが本番環境に加えられた変更で自動的に更新されるためです。ただし、これらの変更がパブリケーションで行われた変更と競合しない場合に限ります。
```

## 競合を自動的に解決する

一部の競合については、Liferayが自動解決を提供できます。 基本的に、自動解決は特定の種類の競合に対する事前構成されたソリューションであるため、それ以上のアクションを実行することなく変更を公開できます。 これらのソリューションには、現在のパブリケーションからコンテンツを追加、変更、または削除することや、本番環境のコンテンツのバージョンをパブリケーションのバージョンに置き換えることなどが含まれます。

自動ソリューションが利用可能になると、公開中に通知されます。 その後、 ［**View**］ をクリックして、ソリューションの詳細を確認することができます。 自動ソリューションを実装するには、［**Publish**］をクリックするだけです。

![自動ソリューションを実装するには、［公開］をクリックするだけです。](./resolving-conflicts/images/01.png)

## 競合を手動で解決する

一部の競合については、Liferayは自動解決を提供できません。 つまり、公開設定を完了する前に、競合を解決するために追加のアクションを実行する必要があります。 手動で解決する必要がある場合、パブリケーションによって競合の種類が識別され、解決するようにプロンプトが表示されます。

![パブリケーションの競合する変更を編集または破棄します。](./resolving-conflicts/images/02.png)

[競合の種類](#understanding-conflict-types) に応じて、パブリケーションは次のアクションのいずれかを実行するように指示する場合があります。

* **編集** ：現在のパブリケーションの競合の原因にリダイレクトされます。 そこから、競合を解決するために必要な変更を加えることができます。

* **破棄** ：破棄されるすべての変更のリストが表示されます。 ［**破棄**］ をクリックして、パブリケーションから完全に削除できます。

```{warning}
破棄は永続的であり、元に戻すことはできません。 パブリケーションから変更を破棄する前に、保持したい変更内容を保存したことを確認してください。
```

## 競合の種類について

ユーザーは、 **重複** 、 **変更** 、 **削除の変更** 、 **変更の削除** 、 **要件の欠落** 、および **追加** の6つの一般的な種類の競合に遭遇する可能性があります。

### 重複の競合

![パブリケーションは、重複の競合を解決するように通知します。](./resolving-conflicts/images/03.png)

これらの競合は、本番環境の何かでパブリケーションで行われた変更と同じ一意の値を使用している場合に発生します。 これは、一意の値を必要とするあらゆるタイプのコンポーネント（フォルダ、URL、ロール名など）が原因で発生する可能性があります。

次の例を考えてみましょう。 「Marketing」という名前の新しいフォルダをパブリケーションに追加し、本番環境のユーザーが同じ名前を使用してフォルダを作成するとします。 同じリポジトリ内のフォルダには一意の名前を付ける必要があるため、変更を公開しようとすると、複製の競合が発生します。

重複の競合を解決するために、ユーザーはパブリケーションの値を編集するか、変更を破棄することができます。

### 変更の競合

![パブリケーションは、変更の競合を解決するように通知します。](./resolving-conflicts/images/04.png)

これらの競合は、パブリケーションで変更したエンティティが本番環境で変更された場合に発生します（たとえば、編集したWebコンテンツの記事が移動された場合）。 一部の変更の競合は自動的に解決できますが、手動による解決が必要なものもあります。

変更の競合を解決するには、競合する資料を編集するか、パブリケーション内の競合する変更を破棄するか、本番環境でバージョンを置き換えることができます。

### 削除の変更と変更の削除の競合

![パブリケーションは、削除の変更と変更の削除の競合を解決するように通知します。](./resolving-conflicts/images/05.png)

これらの競合は、エンティティがパブリケーションで変更されてから本番環境で削除された場合（削除の変更）、またはその逆の場合（変更の削除）に発生します。 この競合に対して提供される唯一の解決策は、パブリケーションの競合する変更を破棄することです。

### 要件の欠落の競合

![パブリケーションは、要件の欠落の競合を解決するように通知します。](./resolving-conflicts/images/06.png)

これらの競合は、子エンティティがパブリケーションで作成または編集されたが、その親が本番環境から削除された場合に発生します。 例としては、パブリケーションでサブフォルダを追加または変更したときに、本番環境からフォルダを削除した場合があります。

要件の欠落の競合を解決するには、パブリケーションから競合する変更を破棄するか、本番環境で削除を元に戻します。 本番環境に公開された変更を元に戻す方法については、 [変更を元に戻す](./reverting-changes.md) を参照してください。

### 追加の競合

![パブリケーションは、追加の競合を解決するように通知します。](./resolving-conflicts/images/07.png)

これらの競合は、ユーザーが既に取り消された削除を含むパブリケーションを元に戻そうとした場合にのみ発生します。 システムはすでに追加されたものを追加し直すことができないため、ユーザーは削除が含まれていた同じパブリケーションを2度元に戻すことはできません。

## 関連トピック

* [パブリケーションの作成と管理](./creating-and-managing-publications.md)
* [変更の作成と公開](./making-and-publishing-changes.md)
* [競合の解決](./resolving-conflicts.md)
