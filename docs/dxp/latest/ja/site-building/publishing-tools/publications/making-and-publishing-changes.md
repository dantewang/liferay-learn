# 変更の作成と公開

{bdg-secondary}`Liferay 7.3以降で利用可能`

パブリケーションは、Liferayインスタンスへの変更を管理するための便利な方法を提供します。 パブリケーションを使用すると、あなたとあなたのチームは、'パブリケーション'と呼ばれる変更のブロックを作成して共同作業できます。 その後、準備ができたら、これらの変更を本番環境に公開できます。

[$LIFERAY_LEARN_YOUTUBE_URL$]=https://www.youtube.com/embed/YNOLwu19oBk

```{note}
デフォルトでは、ユーザーは自分が作成した出版物にのみ投稿できます。 ただし、他のユーザーを招待して、自分のパブリケーションで共同作業を行うことができます。 詳細については、 [パブリケーションでのコラボレーション](./collaborating-on-publications.md) を参照してください。
```

変更を追跡するためのパブリケーションをまだ作成していない場合は、詳細について [Creating a New Publication](./creating-and-managing-publications.md#creating-a-new-publication) を参照してください。

作成されたパブリケーションは、パブリケーションで行われた変更と競合しない限り、本番環境に加えられた変更で自動的に更新されます。 これにより、あなたとあなたのチームは最新バージョンの本番環境で作業をすることができます。

```{important}
Liferayのバージョンをアップグレードした後、既存のパブリケーションを変更、公開、元に戻すことはできません。 すべてのアクティブな出版物は古いものとしてマークされ、表示または削除のみ可能です。 また、アップグレード前に発行された出版物については、*Revert*オプションが削除されます。
```

## パブリケーションに変更を加える

インスタンスに変更を加える前に、本番環境や別のパブリケーションではなく、正しいパブリケーションで作業していることを確認してください。 これは、パブリケーションバーで確認できます。

目的のパブリケーションで現在作業していない場合は、 ［**Select a Publication**］ をクリックして、正しいパブリケーションを選択してください。

![［公開を選択］をクリックして、目的のパブリケーションを選択します。](./making-and-publishing-changes/images/01.png)

パブリケーションで作業している間、サポートされているLiferayコンポーネントに加えられた変更は、パブリケーションで追跡されます。 これには、複数のサイトにまたがる変更も含まれる。

```{important}
同じ出版物の異なるサイトを編集する場合、追跡されたすべての変更は出版物の発行時に本番環境に適用されることに注意してください。
```

パブリケーションでアセットを追加、編集、または削除すると、変更が行われたパブリケーションでのみその変更が表示されます。

各アプリケーションは、アセットのどの部分をパブリケーションで追跡できるかを制御します。 しかし、パブリケーションをサポートしていないアプリケーションやコンテンツタイプに関連するウィジェットでも、ページの一部としてパブリケーションに追加することができます。

```{note}
パブリケーション内のアセットを削除すると、DXPはアセットに削除のマークを付け、パブリケーションを表示するときにそのアセットを非表示にします。 パブリケーションでのアセットの削除は論理的な削除にすぎないため、アセットは本番環境やその他のパブリケーションで引き続き表示できます。
```

## 並行パブリケーションに変更を加える

ユーザーは、同時に複数のアクティブなパブリケーションを持つことができます。 これらの並行パブリケーションで変更が行われると、インスタンスのエンティティの代替編集履歴が作成されます。 これらの変更は、同じコンテンツを変更するか関連するコンテンツを変更するかに応じて、互換性がある場合と競合する場合があります。

### 互換性のある変更

並行パブリケーションに互換性のある変更が含まれている場合、問題なく公開できます。 この場合、両方のパブリケーションの変更履歴が本番環境に適用されます。

### 競合する変更

並行パブリケーションに互換性のない変更が含まれていて、パブリケーションの1つが最初に本番環境に適用された場合、もう一方のパブリケーションで公開設定時に競合が発生します。 これらの競合は、本番環境が直接更新された場合にも発生する可能性があります。 このプロセスの詳細は、 [競合の解決](./resolving-conflicts.md) を参照してください。

## パブリケーションの変更の確認

公開する前に、パブリケーションの変更履歴を確認して、必要な編集のみが含まれていることを確認できます。 これを行うには、［Publications］ドロップダウンメニューを開き、 ［**Review Changes**］ を選択します。

![［Publications］ドロップダウンメニューを開き、［変更の確認］を選択します。](./making-and-publishing-changes/images/02.png)

または、パブリケーションアプリケーションを介して、パブリケーションの変更履歴を確認することもできます。 ［**進行中**］ タブに移動し、目的のパブリケーションの **アクション** ボタン（![Actions button](../../../images/icon-actions.png)ボタン）をクリックして、 ［**Review Changes**］ を選択します。

変更を確認する場合、すべての追跡された変更がリストに表示され、変更タイプ、更新日、サイト、ステータス、タイトル、ユーザーの順に並べることができます。

![変更履歴をリストに表示します。](./making-and-publishing-changes/images/03.png)

### シンプルで高度な変更の概要

デフォルトでは、DXPは変更履歴の簡単な要約を表示しますが、スイッチを ［**Show All Items**］ に切り替えることができます。 これには、変更に関連するすべてのバックグラウンドプロセスが含まれます。

![［すべての項目を表示］に切り替えて、パブリケーションに含まれるすべての変更を確認します。](./making-and-publishing-changes/images/04.png)

個々の変更をクリックすると、詳細が表示されます。 ここから、追跡した変更のアクションボタン( ![Actions button](../../../images/icon-actions.png) )をクリックして、編集または破棄することもできます。 使用可能なアクションは、変更のタイプによって異なります。

![個々の変更をクリックすると、詳細が表示されます。](./making-and-publishing-changes/images/05.png)

### ページへの変更をプレビューする

{bdg-secondary}`利用可能 7.4 U37+およびGA37+`

出版物にページの編集が含まれている場合、その変更をオリジナルバージョンのページと一緒にプレビューすることができます。 これを行うには、変更を確認しながら編集したページをクリックします。

![表示タブでページのバージョンを見る。](./making-and-publishing-changes/images/06.png)

一度選択すると、各ページのバージョンを個別に表示したり、分割表示を選択して両方のバージョンを並べて表示することができます。

![各ページのバージョンを個別に表示するか、スプリットビューを選択して並べて表示することができます。](./making-and-publishing-changes/images/07.png)

## 変更内容の公開

変更作業が完了したら、すぐに公開するか、後で公開するようにスケジュールすることができます。 公開されると、パブリケーションはパブリケーションアプリケーションの［履歴］タブに一覧表示されます。 これにより、明確な監査証跡が維持され、必要に応じてサイトの変更を見直したり、元に戻したりすることができる。 詳細は、 [変更を元に戻す](./reverting-changes.md) を参照してください。

公開プロセスを開始すると、Liferayは互換性チェックを実行して、パブリケーションと本番環境の間に競合があるかどうかを判断します。 競合がある場合は、DXPから通知されます。 一部の競合は自動的に解決されますが、その他の競合は手動で解決する必要があります。 変更を公開するには、すべての競合を解決する必要があります。 詳細は、 [競合の解決](./resolving-conflicts.md) を参照してください。

### 今すぐ公開

次の手順に従って、変更をすぐに公開します。

1. ［Publications］ドロップダウンメニューを開き、 ［**変更の確認**］ を選択します。

   または、パブリケーションアプリケーションを開き、目的のパブリケーションをクリックします。

1. ［**Publish**］ をクリックします。

   ![目的のパブリケーションに移動し、 [発行]をクリックします。](./making-and-publishing-changes/images/08.png)

1. 必要に応じて、検出された競合を手動で解決します。 すべての競合が解決されたら、次に進むことができます。

   ![公開する前に、すべての競合を解決します。](./making-and-publishing-changes/images/09.png)

1. ［**Publish**］ をクリックします。

パブリケーションの変更はすぐに本番環境に適用され、［履歴］タブにリダイレクトされます。  ここから、公開設定の詳細（日付、発行者、ステータスなど）を表示し、必要に応じてパブリケーションの変更を[元に戻す](./reverting-changes.md)ことができます。

### 後でスケジュールする

次の手順に従って、後日の公開をスケジュールします。

1. ［Publications］ドロップダウンメニューを開き、 ［**変更の確認**］ を選択します。

   または、パブリケーションアプリケーションを開き、目的のパブリケーションをクリックします。

1. **スケジュール** をクリックする。

   ![目的の出版物に移動し、「スケジュール」をクリックします。](./making-and-publishing-changes/images/10.png)

1. 必要に応じて、検出された競合を手動で解決します。 すべての競合が解決されたら、次に進むことができます。

   ```{important}
   公開時に、DXPは2回目の競合検出を実行して、新たな競合する変更がないことを確認します。 DXPが自動的に解決できない新しい競合を検出すると、公開は失敗します。 競合を自動的に解決できる場合、DXPは公開を続行します。
   ```

1. 日付と時刻を入力して、変更が本番環境に公開されるタイミングを決定します。

   ![変更を公開する日時を設定します。](./making-and-publishing-changes/images/11.png)

1. **スケジュール** をクリックして完了です。

[このタブでは、スケジュールされた出版物の表示と管理](./creating-and-managing-publications.md#managing-scheduled-publications) を行うことができます。

## 不要な出版データの削除

出版物の変更を確認する際、ファイルやページのプレビューがドキュメント・ライブラリに蓄積されることがあります。 必要であれば、このデータを削除することもできる。

1. **Global Menu**(![Global Menu](../../../images/icon-applications-menu.png)) を開き、 **Control Panel** に進み、 **System Settings** をクリックします。

1. Platform の下にある **Upgrades** をクリックします。

1. **データ削除** タブに移動する。

1. 選択 **削除 DL プレビュー 変更 追跡 保存 コンテンツ データ** .

   ![変更追跡オプションをチェックしてください。](./making-and-publishing-changes/images/12.png)

1. ［**Save**］ をクリックします。

Liferayは直ちに不要なデータを削除します。

## 関連トピック

* [パブリケーションの概要](../publications.md)
* [パブリケーションの有効化](./enabling-publications.md)
* [パブリケーションの作成と管理](./creating-and-managing-publications.md)
