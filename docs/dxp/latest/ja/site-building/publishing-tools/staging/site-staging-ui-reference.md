# サイトステージングUIリファレンス

ローカルまたはリモートのライブステージングを有効にすると、ほとんどのページ設定オプションはステージング環境でのみアクセスできるようになります。 これにより、ユーザーがライブページを直接編集することができなくなります。

Stagingを有効にすると、Staging環境に追加のオプションが表示されます。 これらのオプションは、ステージングバー、Publish to Liveメニュー、およびステージングページ内にあります。

## ステージングバーと編集ツール

サイトに対してステージングを有効にすると、サイトの各ページにあるステージング・バーから追加のオプションにアクセスできるようになります。 このバーでは、ステージング環境とライブ環境を切り替え、ステージングされたページについては、 **Publish to Live** をクリックすることができます。

![サイトに対してステージングを有効にすると、サイトの各ページでステージングバーにアクセスできます。](./site-staging-ui-reference/images/01.png)

以下の表と写真で、ウィジェットページのステージングバーオプションと編集ツールについて説明します。

| オプション           | ウィジェットページ                                       | # |
|:--------------- |:----------------------------------------------- |:- |
| **サイトページバリエーション** | <ul><li>ステージングされたサイトのページセットのバリエーションを、ドロップダウンメニューで切り替えることができます。</li><li>Staging Barの **Actions** ボタンをクリックし、 **Site Pages Variation** を選択して、ページセットのバリエーションを管理・作成します。 詳細については、 [ページバージョニング](./page-versioning.md) を参照してください。</li></ul>                       | 1 |
| **ページバリエーション** | <ul><li>ドロップダウンメニューで、ステージングサイト内の1ページのバリエーションを切り替えられます。</li><li>Staging Barの **Actions** ボタンをクリックし、 **Page Variations** を選択して、ページバリエーションを管理・作成します。 詳細については、 [ページバージョニング](./page-versioning.md) を参照してください。</li></ul>                       | 2 |
| **元に戻す/やり直す** | <ul><li>Staging Barの **Actions** ボタンをクリックし、 **Undo** / **Redo** を選択します。</li><li>ページを **Ready for Publish Process** としてマークすると、最近の変更を元に戻したり、やり直したりすることができなくなります。</li></ul>                       | 3 |
| **履歴** | <ul><li>Staging Barの **Actions** ボタンをクリックし、 **History** を選択して、ページの改訂履歴を管理します。</li><li>ページを以前のバージョンに戻すには、復元したいページのバージョンの **アクション** ボタンをクリックし、 **出版プロセスの準備としてマーク** を選択します。</li></ul>                       | 4 |
| **公開処理可能** | <ul><li>Ready for Publish Process **をクリックすると、ページのステータスが** Draft **から** Ready for Publish Process **に変更されます。</li><li>** 本番環境に公開 **をクリックして、変更の公開を構成および開始します。</li><li>Liveにページを公開すると、** Ready for Publish Process*と表示されたバージョンのみが公開されます。</li></ul>                       | 5 |
| コンテンツの編集        | Liferayアプリケーションバーの ［**Add**］ ボタンを使用して、ウィジェットを編集します。 | 6 |

![ウィジェットページのステージングバーと編集ツールを使用します。](./site-staging-ui-reference/images/02.png)

## 本番環境に公開

［**Publish to Live**］ をクリックすると、公開プロセスを設定するための追加オプションを含むモーダルウィンドウが表示されます。 ［**Simple**］ または ［**詳細設定**］ 設定を使用して公開できます。

![ [本番環境に公開]をクリックして、公開モーダルウィンドウにアクセスします。](./site-staging-ui-reference/images/03.png)

## シンプルな公開

**Name** ：公開プロセスのわかりやすい名前を ［**Name**］ フィールドに入力します。

**Changes Since Last Publish Process** ：最後の公開プロセス以降に行われたステージングされた変更を表示します。

**Pages to Publish** : 現在の公開処理に含まれるページ数を表示します。

```{note}
Stagingフレームワークで追跡されたページ削除数を表示します。 この数字は、ステージングサイトでのページ削除数であり、ライブサイトで削除されるページ数ではありません。 公開するページ削除数と、StagingサイトとLiveサイトのいずれかに存在する実際のページ数との間に矛盾が生じることがあります。
```

準備ができたら、 ［**Publish to Live**］ をクリックして公開を開始します。

![ [本番環境に公開]をクリックして、公開を開始します。](./site-staging-ui-reference/images/04.png)

## 高度な公開

高度な公開を使用すると、公開プロセスをカスタマイズするために使用できる情報と設定にアクセスできます。 **Custom** タブでは、内容、日付、ページなどを指定することができます。 または、 ［**Publish Template**］ タブをクリックして、公開プロセス用に事前設定されたテンプレートを選択します。 詳細設定にアクセスするには、モーダルウィンドウで ［**Switch to Advanced Publish Process**］ をクリックします。

![詳細設定を使用して、公開プロセスをカスタマイズします。](./site-staging-ui-reference/images/05.png)

カスタムの詳細設定は、次のセクションに分かれています。

**Name** ：公開プロセスのわかりやすい名前を ［**Name**］ フィールドに入力します。

**日付** ：変更をすぐに公開するか、 後で公開するように **スケジュール** するかを選択します。 また、公開プロセスを繰り返すかどうか、および繰り返す頻度を決定することもできます。

![変更をいつ公開するかを選択します。](./site-staging-ui-reference/images/06.png)

**Deletions** ： **インポートする前にアプリケーションデータを削除する** かどうか、および **個々の削除を複製する** かどうかを選択します。

![インポートする前にアプリケーションデータを削除するかどうか、および個々の削除を複製するかどうかを選択します。](./site-staging-ui-reference/images/07.png)

**Pages** : 公開するページセットのバリエーションと個々のページ、および選択したページのルック＆フィールを選択します。 また、 **Delete Missing Pages** を選択すると、Live サイトから Staging サイトに存在しないすべてのページが削除されます。 ページメニューから公開するページを選択した場合、ウィジェットとその参照先は常に公開されます。

![公開するページセットのバリエーションや個々のページ、選択したページのルック＆フィールを選択することができます。](./site-staging-ui-reference/images/08.png)

カスタムテーマでページを公開したい場合は、ステージング構成の **ルック＆フィール** 見出しの下にあるテーマ設定オプションをチェックする必要があります。それ以外の場合は、デフォルトのテーマが適用されます。

**コンテンツ** ：公開プロセスに含めるコンテンツを選択します。 ラジオボタンを使用して、選択したタイプの **すべての** コンテンツを公開するか、日時のパラメーターを指定して公開されるコンテンツを制限できます。 このオプションを使用して、ステージングで変更され、公開待ちとなっているコンテンツを確認することもできます。

![公開プロセスに含めるコンテンツを選択します。](./site-staging-ui-reference/images/09.png)

| オプション     | 説明                            |
|:--------- |:----------------------------- |
| **すべて** | 公開可能なすべてのコンテンツを表示します。         |
| **最新公開日から** | 前回の公開以降に更新されたコンテンツのみが表示されます。  |
| **日付の範囲** | 特定の期間に更新されたコンテンツを表示します。       |
| **最後へ** | 過去数時間または数日間に更新されたコンテンツを表示します。 |

```{note}
［コンテンツ］オプションを選択したら、*カウントを更新*をクリックして結果の数を更新します。
```

また、コンテンツタイプごとに ［**Change**］ をクリックして、 **バージョン履歴** 、 **ボキャブラリ** 、 **プレビューとサムネイル表示** など、各タイプに含まれるアイテムやその他の設定を管理することもできます。 詳細は、[ステージングでのデータとコンテンツタイプの管理](./managing-data-and-content-types-in-staging.md)を参照してください。

```{important}
デフォルトでは、動的データリスト(DDL)表示、フォーム、Webコンテンツの表示、およびWiki表示のウィジェットを使用して表示されるコンテンツは、公開プロセスに常に含まれています。 Liferay DXP/Portal 7.4以降では、この動作を無効にして、表示されるコンテンツが公開プロセスの構成に明示的に含まれている場合にのみ公開されるようにすることができます。 詳細については、 [表示されたコンテンツの自動公開の設定](./configuring-automatic-publishing-of-displayed-content.md) を参照してください。
```

**Permissions** : 変更を公開する際に、ページやウィジェットのパーミッションを含めるかどうかを選択します。

![変更を公開する際に、ページやウィジェットの権限を含めるかどうかを選択します。](./site-staging-ui-reference/images/10.png)

ページやコンテンツを公開するたびに高度なオプションを手動で設定する代わりに、ステージング設定を [**公開テンプレート**](#publish-templates) として保存しておけば、将来的に利用することができます。 公開プロセス用に保存されたテンプレートを表示および選択するには、 ［**Publish Templates**］ タブをクリックします。

![公開プロセス用に保存されたテンプレートを表示および選択するには、［公開テンプレート］タブをクリックします。](./site-staging-ui-reference/images/11.png)

準備ができたら、 ［**Publish to Live**］ をクリックして公開を開始します。

## ステージングページ

ステージングを有効にすると、 ［**Publishing**］ タブから使用できるオプションが変更されます。 本番環境では、 **エクスポート** 機能にのみアクセスできます。 ステージング環境では、 **インポート** および **ステージング** 機能にのみアクセスできます。

また、Stagingページでは、新しいオプションにアクセスできます。公開プロセスの表示、公開テンプレートの作成と管理、サイトのStagingの変更と無効化などが可能です。

![また、Stagingページで新しいオプションにアクセスできます。](./site-staging-ui-reference/images/12.png)

### 以前および将来の公開プロセス

ステージングを使用して公開すると、 **プロセス** としてキャプチャされ、後で参照できるように保存されます。 これらのプロセスを表示および管理するには、 ［**サイトメニュー**］ &rarr; ［**公開設定**］ &rarr; ［**Staging**］ に移動します。

［**Processes**］ タブには、完了したステージングプロセスのリストがあります。 ここから、プロセスの **アクション** ボタン（![Actions button](../../../images/icon-actions.png)）をクリックして、以前のパブリケーションの **概要** を **再開** 、 **クリア** 、または表示できます。

![Stagingページで過去のパブリッシングプロセスを表示・管理できます。](./site-staging-ui-reference/images/13.png)

**追加**（![Add button](../../../images/icon-add.png)）ボタンをクリックして、カスタム設定または事前定義された公開テンプレートを使用して新しい公開プロセスを作成することもできます。

［**予定済み**］ タブでは、すべての予定済みの公開プロセスを表示できます。

### 公開テンプレート

同様のステージング設定を定期的に作成する場合は、独自の **公開テンプレート** を作成して時間を節約できます。 テンプレートを作成するには、 **Staging** ページの **Application** バーにある **Actions**( ![Actions button](../../../images/icon-actions.png) ) をクリックします。 次に、 **Publish Templates** を選択します。

![StagingページのアプリケーションバーにあるActionsボタンをクリックします。](./site-staging-ui-reference/images/14.png)

ここから、頻繁に公開する設定のテンプレートを作成および管理できます。 次に、 **アクション** ボタン（![Actions button](../../../images/icon-actions.png)）をクリックして ［**Publish**］ を選択すると、テンプレートを使用できます。

![頻繁に公開する設定のテンプレートを作成および管理します。](./site-staging-ui-reference/images/15.png)

Staging Bar の **Publish to Live** ボタンを使ってページやコンテンツを公開する際に、テンプレートを使用することができます。 詳細は、 [Advanced Publishing](#advanced-publishing) を参照してください。

### ステージング設定

Staging の設定後、 **Staging** ページの **Application** バーにある **Actions**( ![Actions button](../../../images/icon-actions.png) ) をクリックすると、 Staging Configuration ページにアクセスすることができます。 次に、 ［**Staging Configuration**］ を選択します。

![StagingページのアプリケーションバーにあるActionsボタンをクリックし、Staging Configurationにアクセスします。](./site-staging-ui-reference/images/16.png)

ここから、あなたのサイトのステージングを無効にしたり、 [ページバージョニング](page-versioning.md) の設定を変更したりすることができます。 ただし、 ［**ステージコンテンツ**］ オプションは、初期設定後に変更することはできません。

## 関連トピック

* [ステージングの概要](../staging.md)
* [公開プロセスを理解する](./understanding-the-publishing-process.md)
* [ページバージョニング](./page-versioning.md)
* [ステージングでのデータとコンテンツタイプの管理](./managing-data-and-content-types-in-staging.md)
