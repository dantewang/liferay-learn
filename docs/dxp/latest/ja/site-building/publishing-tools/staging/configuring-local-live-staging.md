# ローカル現行環境ステージングの設定

ローカルライブステージングでは、ステージング環境とライブ環境の両方が同じLiferayサーバー上でホストされます。 有効にすると、Liferay DXPはステージング環境となるサイトやアセットライブラリのローカルクローンを作成し、オリジナルはライブ環境になります。 両方の環境は、同じJVM、データベース、選択されたアプリケーションデータ、および構成（ポータルプロパティなど）を共有します。

![ローカルステージングは、同じサーバー上で両方の環境をホストする。](./configuring-local-live-staging/images/01.png)

## サイトのローカル現行環境ステージングの設定

1. ［**サイトメニュー**］ &rarr; ［**Publishing**］ &rarr; ［**Staging**］ に移動します。

   ![サイトメニューの［ステージング］に移動します。](./configuring-local-live-staging/images/02.png)

1. ［**Local Live**］ を選択すると、 ［**ページバージョニング**］ と ［**ステージコンテンツ**］ の追加フィールドが表示されます。

   ![ [ローカル現行環境]を選択します。](./configuring-local-live-staging/images/03.png)

1. (サイトのみ）**Page Versioning** を有効にするかどうかを選択します。

   ![ページバージョニングを有効にします。](./configuring-local-live-staging/images/04.png)

1. ステージングするデータとコンテンツのタイプを選択します。

   ![ステージングするデータとコンテンツのタイプを選択します。](./configuring-local-live-staging/images/05.png)

   ```{warning}
   アプリケーションがチェックされると、そのデータはステージング環境にコピーされます。 アプリケーションのチェックを外すときは、まず、ステージングでの変更がすべてパブリッシュされていることを確認してください。 詳細については、 [ステージングでのデータとコンテンツタイプの管理](./managing-data-and-content-types-in-staging.md) を参照してください。
   ```

1. ［**保存**］ をクリックして、クローン作成プロセスを開始します。 このプロセスにかかる時間は、サイトの規模によって異なります。

   ```{tip}
   ページのバージョニングを有効にして初めて更新履歴が記録されるため、クローン作成にかかる時間を短縮し、サイトの更新履歴をより完全に記録するために、サイトを早い段階でステージングします。
   ```

プロセスが完了したら、ローカルライブステージングを使用する準備が整いました。 ステージング環境のパブリッシング機能のナビゲートについては、 [サイトステージングUIリファレンス](./site-staging-ui-reference.md) 。

## アセットライブラリのステージングの設定

1. **グローバルメニュー**（![Global Menu](../../../images/icon-applications-menu.png)）を開き、［Applications］タブの ［**アセットライブラリ**］ をクリックします。

1. 目的のアセットライブラリを開き、パブリッシングの下にある **ステージング** をクリックします。

1. ［**Local Live**］ を選択します。

   ![ [ローカル現行環境]を選択します。](./configuring-local-live-staging/images/06.png)

1. ステージングするアプリケーションデータを選択します。

   アセットライブラリの場合、 **ドキュメントとメディア** 、および **Webコンテンツ** のデータをステージングできます。

   ![ステージングするアプリケーションデータを選択します。](./configuring-local-live-staging/images/07.png)

1. ［**保存**］ をクリックして、クローン作成プロセスを開始します。 このプロセスにかかる時間は、アセット・ライブラリのサイズによって異なります。

   プロセスが完了すると、アセットライブラリでローカルライブステージングを使用する準備が整います。

## ローカル現行環境ステージングの無効化

何らかの理由でサイトやアセットライブラリのステージングを無効にしなければならない場合は、ステージング環境から行うことができます。 ただし、ローカルライブのステージングを無効にすると、ステージング環境とすべての未公開コンテンツが削除されることに注意してください。 このため、ステージングを無効にする前に、必要な情報がすべてパブリッシュされているか、別の場所に保存されていることを確認してください。

```{tip}
ステージング環境の規模によっては、このプロセスに時間がかかる場合があります。 Liferayインスタンスがビジーな時はステージングを無効にしない方が良いでしょう。
```

ローカルライブステージングを無効にするには、以下の手順に従ってください：

1. サイトまたはアセットライブラリでステージングアプリケーションを開きます。

1. アプリケーションバーの **アクション**（![Actions button](../../../images/icon-actions.png)）をクリックし、 ［**Staging Configuration**］ を選択します。

   ![アプリケーションバーのアクションボタンをクリックし、［ステージング設定］を選択します](./configuring-local-live-staging/images/08.png)

1. **設定に「なし**」 を選択し、 「**保存**」 をクリックします。

```{important}
ほとんどのコンテンツタイプでは、ステージングは各コンテンツアイテムの承認された最新バージョンのみを公開します。 このため、ローカルライブのステージングを無効にすると、古いバージョンのコンテンツ（ドキュメントなど）が失われます。 ステージングを無効にすると、ライブ環境での最新の公開バージョンだけが保存されます。 ウェブコンテンツだけは例外だ。
```

## 関連トピック

* [ステージングの概要](../staging.md)
* [サイトステージングUIリファレンス](./site-staging-ui-reference.md)
* [ステージングでのデータとコンテンツタイプの管理](./managing-data-and-content-types-in-staging.md)
* [ステージング権限の管理](./managing-staging-permissions.md)
