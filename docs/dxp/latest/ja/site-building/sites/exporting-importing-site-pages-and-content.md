# サイトページとコンテンツのエクスポート/インポート

Liferay Sitesには、サイトデータをLiferay Archive(LAR）ファイルとして抽出・転送するためのExport/Importアプリケーションが含まれています。 これらのツールは、サイトレベルでアクセスすることができます。

```{note}
また、個々のサイトアプリケーションや[ページウィジェット](../creating-pages/page-fragments-and-widgets/using-widgets/configuring-widgets/exporting-importing-widget-data.md) に対してエクスポートやインポート機能を利用できます。
```

## サイトLARのプロパティと要件

LARにはこのようなプロパティと要件があります。

* LARはバージョンによって異なります。 各サーバーのLiferayのバージョンが同じであれば、別のLiferayサーバーのSiteにインポートすることができます。

* 一部の命名の衝突は自動的に処理されます。 例えば、インポートするLARとサイトの両方に同じフレンドリーURLのページがある場合、フレンドリーURLに数字が付加され、競合が発生しなくなるまで増加します。 カテゴリー名についても同様です。

* LARを使用してサイトを復元することができますが、サイトを完全に削除してから、LARをインポートするために同じ名前で新しいサイトを作成する必要があります。 これにより、LARと本サイトの両方に存在するコンテンツの間でデータが衝突する可能性を回避できます。

```{important}
LARを定期的にエクスポートすることは、バックアップソリューションではなく、2つの環境間でデータを移行するためにのみ使用されるべきものです。 Liferayインストールのバックアップについては、[Liferay Portalインストールのバックアップ](../../installation-and-upgrades/maintaining-a-liferay-installation/backing-up.md) を参照してください。
```

## サイトのページやコンテンツをエクスポートする

以下の手順で、「サイトページ」と「コンテンツ」をエクスポートします：

1. *サイトメニュー* (![Site Menu](../../images/icon-product-menu.png)) を開き、 *パブリッシング*を展開し、 *エクスポート*をクリックします。

1. *Add* ボタン (![Add Button](../../images/icon-add.png)) をクリックして、新しいエクスポートプロセスを作成します。

   エクスポートテンプレートを開きます。

   ![エクスポートテンプレートの名前を付け、設定する。](./exporting-importing-site-pages-and-content/images/01.png)

1. エクスポートプロセスのタイトルを入力します。

1. エクスポートしたいサイトページとコンテンツを選択し、エクスポートプロセスを設定します。

   *Pages* では、どのページとページセットをエクスポートに含めるかを選択することができます。 また、テーマ設定、ロゴ、サイトページ設定、サイトテンプレート設定の有無も判断できます。

   *コンテンツ*で、どのアプリケーションをエクスポートに含めるかを選択することができます。 また、選択したアプリケーションのすべてのデータをエクスポートするか、含まれるアプリケーションのデータを日付や時間でフィルタリングするかを決定することができます。

   *Permissions*で、ページとコンテンツの権限をエクスポートに含めるかどうかを決定します。

1. *Export* をクリックし、エクスポート処理を開始します。

終了後、 *Download* ボタン (![Download Button](../../images/icon-download.png)) をクリックし、生成された LAR ファイルをダウンロードします。 これで、LARを別のLiferay Siteにインポートすることができます。

![LARファイルをダウンロードします。](./exporting-importing-site-pages-and-content/images/02.png)

```{note}
生成されたLARには、エクスポート設定時に選択したすべてのデータが含まれます。 個人情報や機密情報が含まれる場合は、LARファイルが安全な場所に保管されていることを確認してください。
```

## サイトのページやコンテンツをインポートする

```{important}
エクスポートされたサイトがテンプレートを使用している場合、サイトをインポートする前に、まずサイトテンプレートをLiferayのインストールにエクスポートしてインポートする必要があります。 詳しくは、「サイトテンプレートのエクスポートとインポート」(./site-templates/exporting-importing-site-templates.md) をご覧ください。
```

以下の手順で、「サイトページ」と「コンテンツ」をインポートします：

1. *サイトメニュー* (![Site Menu](../../images/icon-product-menu.png)) を開き、 *出版*を展開し、 *輸入*をクリックします。

1. *Add* ボタン (![Add Button](../../images/icon-add.png)) をクリックして、新しいインポート処理を作成します。

1. 希望のLARファイルを追加し、 *Continue*をクリックします。

   ![LARファイルを追加し、［続ける］をクリックします。](./exporting-importing-site-pages-and-content/images/03.png)

1. インポートプロセスを確認し、設定する。

1. *インポート* をクリックすると、インポートが開始されます。

   ![設定し、インポート処理を開始します。](./exporting-importing-site-pages-and-content/images/04.png)

## テンプレートのエクスポートの作成

サイトページコンテンツをエクスポートするたびにエクスポートプロセスを手動で作成する代わりに、エクスポートテンプレートを作成し、エクスポート設定を保存して再利用することができます。 エクスポートテンプレートを作成するには、以下の手順で行います。

1. *サイトメニュー* (![Site Menu](../../images/icon-product-menu.png)) を開き、 *パブリッシング*を展開し、 *エクスポート*をクリックします。

1. アプリケーションバーの *アクション* ボタン ![Actions Button](../../images/icon-actions.png) をクリックし、 *テンプレートのエクスポート*を選択します。

   ![アプリケーションバーの「アクション」ボタンをクリックし、「テンプレートのエクスポート」を選択します。](./exporting-importing-site-pages-and-content/images/05.png)

1. *追加* ボタン (![Add Button](../../images/icon-add.png)) をクリックします。

1. エクスポートテンプレートの名前を付け、設定する。

1. *［Save］* をクリックします。

[新しいエクスポートプロセスを作成する際に、テンプレートを選択できるようになりました](#exporting-site-pages-and-content)。

## エクスポート/インポートプロセスを設定する

Liferayは、エクスポート/インポート処理とStaging固有の機能を構成するための設定を提供します。 これらの設定は、StagingとSite Templateの伝播に影響します。

| 設定                   | Description                                                                                                                                                   |
|:-------------------- |:------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| すべてのアセットリンクを含める      | チェックした場合、指定した日付範囲内のサイトからすべての資産リンクが含まれます。 チェックを外すと、コンテンツに接続されたアセットリンクのみが含まれます。                                                                                 |
| 個々の削除をデフォルトで反映する     | チェックした場合、コンテンツタイプに対して行われた削除操作は、デフォルトで常にターゲットサイトに複製されます。                                                                                                       |
| デフォルトで権限を公開する        | チェックした場合、エクスポートされたページと個々のポートレットウィンドウに割り当てられたパーミッションは、デフォルトで常に含まれます。                                                                                           |
| ファイルエントリの検証          | チェックした場合、テキストを含むコンテンツタイプを公開またはインポートすると、Liferayはコンテンツにドキュメントへのリンクがあるかどうかをチェックし、それらが有効なドキュメントを指していることを確認します。                                                    |
| Journal Feedの参照を検証する | チェックした場合、テキストを含むコンテンツタイプを公開またはインポートすると、LiferayはWebコンテンツフィードへの参照を確認し、有効なフィードを指すことを確認します。                                                                       |
| レイアウトの参照を検証します。      | チェックした場合、テキストを含むコンテンツタイプを公開またはインポートすると、Liferayはポータルのバーチャルホストの1つへのリンクがあるかどうかを確認し、有効なLiferayページを指していることを確認するようになります。 バーチャルホストにLiferayにないページがある場合は、チェックを外してください。 |
| 欠落している参照を検証します。      | チェックした場合、パブリッシングとインポート処理で、Liferayは参照先が不足していないかチェックします。 チェックをはずすと、Missing Referenceのバリデーションはスキップされます。 その結果、既存のターゲットがないリファレンスでも、ターゲットサイトへのパブリッシュやインポートが可能になります。 |

## 追加情報

* [サイトの追加](./adding-a-site.md)
* [サイトテンプレート](./site-templates.md)
* [サイトテンプレートのエクスポート/インポート](./site-templates/exporting-importing-site-templates.md)
