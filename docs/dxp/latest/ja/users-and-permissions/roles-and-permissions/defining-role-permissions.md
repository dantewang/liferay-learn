# ロール権限の定義

ロールは権限を収集するため、ユーザーにロールが付与されると、ユーザーはすべてのロールの権限を継承します。

コントロールパネルで何かにアクセスする権限を持つロールを作成すると、 **コントロールパネルメニューを見る** 権限が自動的に付与されます。

Liferay DXP内でアクションを実行する権限を決定するには、反復が必要です。 1つまたは2つの権限を追加してから、ロールをテストして、表示される動作が期待どおりであることを確認します。 より多くのロールを作成するにつれて、特定のタスクを実行するために権限を組み合わせる方法をよりよく理解できます。

```{tip}
ロールにユーザーを割り当て、 [ユーザーとして代理ログイン](./../users/adding and-managing-users.md#impersonating-users) すると、そのユーザーがロールから継承した権限を確認することができます。
```

Liferay DXPで任意のロールの権限を定義するには、

1. コントロールパネルに移動し、 ［**ユーザー**］ &rarr; ［**ロール**］ をクリックします。

1. 通常のロール、サイトのロール、組織ロール、またはアセットライブラリのロールをクリックするか、 [新しいロールを作成します](./creating-and-managing-roles.md)。

1. ロール編集者画面から、 ［**Define Permissions**］ タブをクリックします。

1. ロールの権限を収集し、 ［**保存**］ をクリックします。

![ロールの権限を定義して、そのユーザーがタスクを実行できるようにします。](./understanding-roles-and-permissions/images/04.png)

もちろん、作業の大部分は、ロールの権限を選択することです。 検索バーを使用して、必要な権限を見つけます。

```{note}
コントロールパネルのロールアプリケーションがメインですが、権限が構成されている唯一の場所ではありません。 リソースに対するロールの権限をより詳細なレベルで構成できます。 たとえば、［権限］メニューから特定のウィジェットの権限を構成できます。 コントロールパネルで付与または削除されたアクセス許可は、より詳細なレベルで定義されたアクセス許可を上書きします。
```

## 例：ユーザーグループマネージャーの定義

仮想インスタンスでユーザーグループを管理できる新しいロールを作成するには、割り当てられた [ロールのユーザー](./assigning-users-to-roles.md) が仮想インスタンスのすべてのユーザーグループに作用できるように、ユーザーグループマネージャーのロールの権限を定義する必要があります。

- ユーザーを任意のユーザーグループに追加します。
- ユーザーグループからユーザーを削除します。

タイトル **User Group Manager** の標準ロールが作成されたら、［権限の定義］画面に移動し、

1. 左側のメニューでドリルダウンして、 ［**コントロールパネル**］ &rarr; ［**ユーザー**］ &rarr; ［**ユーザーグループ**］ へ行きます。

   または、検索バーに **user groups** と入力して、権限メニューをフィルタリングします。

   ![検索バーを使用して、関連する権限への権限のリストをフィルタリングします。](./defining-role-permissions/images/01.png)

1. ［**通常権限**］ の見出しで、 ［**コントロールパネルのアクセス**］ と ［**表示**］ のフラグを立てます。 これにより、ユーザーグループ管理者はユーザーグループコントロールパネルポートレットにアクセスして、既存のユーザーグループを表示できます。

1. ユーザーグループマネージャーがユーザーグループを表示し、メンバーを割り当てることができるようにしたいので、 **メンバーを割り当てる** と **表示** の権限を **リソース権限** → **ユーザーグループ** 見出しで確認します。

1. ［**保存**］ をクリックします。

![ユーザーグループマネージャーのロールに割り当てられたユーザーは、使用可能なユーザーを任意のユーザーグループに追加したり、削除したりできます。](./defining-role-permissions/images/02.png)

これで、ユーザーグループマネージャーのロールには、ユーザーをユーザーグループに追加するために必要なすべての権限が付与されます。 ユーザーグループマネージャーは、コントロールパネルでユーザーグループの表示、メンバーの割り当て、ユーザーグループへのアクセスを行うことができます。 ユーザーを表示してロールのメンバーとして割り当てる必要があるため、コントロールパネルでユーザーを表示する権限が必要でした。 この権限がない場合、ユーザーをロールに追加しようとすると、ユーザーグループのマネージャーには空のリストが表示されます。

## 権限の概要

権限には次の3つのカテゴリがあります。

**コントロールパネル** : ポータル管理者は、コントロールパネル全体にアクセスできます。 コントロールパネルのアクセス許可は、コントロールパネルがさまざまなロールユーザーに表示されるかどうか、およびどのように表示されるかに影響します。 たとえば、ロールがコントロールパネルのさまざまなアプリケーションへの表示アクセスを許可するかどうかを微調整したり、より細かくしてアプリケーションの構成アクションへのアクセスのみを許可したりできます。

**サイトとアセットライブラリの管理** ： サイト管理者は、サイト管理カテゴリに属するサイト管理ツールにアクセスできます。 サイトとアセットライブラリの管理 &rarr; アプリケーションカテゴリの権限は、Wikiやメッセージボードなどのアプリケーションで作成できるコンテンツを管理します。 このリストからいずれかのアプリケーションを選択すると、そのコンテンツに対する権限を定義するためのオプションが表示されます。 たとえば、掲示板を選択すると、カテゴリとスレッドの作成、またはトピックの削除と移動の権限が表示されます。

サイトアプリケーションの権限は、ロールのスコープ全体（たとえば、通常のロールの仮想インスタンス内のすべてのサイト）全体でアプリケーションに影響します。 たとえば、掲示板ウィジェットを組織ロールのページに追加する権限を掲示板アプリケーションに付与すると、このロールを持つ組織ユーザーは、 [組織](../organizations/understanding-organizations.md)が所有するサイトの任意のページでアクションを実行できます。

**ユーザー：** デフォルトでは、ユーザーはユーザーロールを継承し、ユーザーカテゴリに属する権限を介してユーザーアカウントを管理できます。 これらの権限を使用して、ユーザーの新しいロールを定義し、ユーザーのアカウントにデフォルトのユーザーロールよりも少ない権限を提供できます。 次に、 [デフォルトユーザーの関連付け](./assigning-users-to-roles.md#default-user-associations) 構成を使用して、元のユーザーロールをより制限的なロール（おそらく、 **制限付きユーザー** または **カスタムユーザー** と名付けてそれを区別するロール）に置き換えることができます。

自分を1つのカテゴリに限定しないでください。カスタムのロールを定義するときに、これらすべてのカテゴリの権限を混在させて一致させることができます。

```{tip}
権限の範囲を変更できます。権限の表の*範囲*列にある*変更*リンクをクリックして、新しい範囲を選択します。 ［*保存*］をクリックして、現在ロールに付与されているすべての権限とそのスコープのリストを表示します。 概要ビューから、*戻る*（<）アイコンをクリックして、権限を追加したり、ロールアプリケーションのデフォルトビューに戻ることができます。
```

![権限のスコープを変更することで、ロールの権限を微調整できます。](./defining-role-permissions/images/03.png)

特定のアクセス許可によって、期待した以上のアクセスが許可されることがあります---常にアクセス許可の構成をテストしてください。

## トラブルシューティングサイトロールにグローバルビュー権限が必要な場合がある

サイトロールは、定義上、サイトの範囲外のエンティティに作用する権限を定義することはできません。 これは、カスタムロールで管理者タイプのパーミッションを定義する際に問題となります。 例えば、デフォルトのサイト管理者ロールをカスタムサイト管理者ロールで複製しようとすると **Site and Asset Library Permissions** &rarr; **People** &rarr; **Membership** 権限をすべて追加しても、新しいメンバーをサイトに割り当てるには十分ではないことがわかります。 サイトメンバーではないユーザーは、カスタムサイト管理者には表示されません。 適切な権限を付与するためには、［サイトロール］の上に［標準ロール］が必要です。 標準ロールにユーザーリソースのビュー権限を与えるには、ロールアプリケーションの ［**権限の定義**］ セクションに移動します。その後、 ［**コントロールパネル**］ &rarr; ［**ユーザー**］ &rarr; ［**ユーザーと組織**］) に移動します。 ［サイトロール］と［標準ロール］を持つユーザーが、システム内の［ユーザー］を確認し、［サイト］に追加できるようになりました。

```{note}
［サイト管理者］は、［ユーザー］を表示する権限を自動的に付与します。
```

## ソーシャルアクティビティ構成の委任

サイト管理者がソーシャルアクティビティを構成する責任を他のユーザーに委任できる権限があります。 この権限をロールに追加するには、目的のロールの横にある **アクション** をクリックし、 ［**権限の定義**］ を選択します。 **サイト管理** &rarr; **設定** &rarr; **ソーシャルアクティビティ** 権限カテゴリーを探します。 すべての権限にフラグを付けて、 ［**保存**］ クリックします。

- サイト管理にアクセス
- 設定
- 権限設定
- 表示設定
- 参照

これらの権限が付与されると、ロール担当者はサイトのソーシャルアクティビティを管理できます。

ロールは、さまざまな権限を任意の組み合わせでグループ化します。 これにより、設計したサイトを構築するための柔軟性が最大限に高まります。
