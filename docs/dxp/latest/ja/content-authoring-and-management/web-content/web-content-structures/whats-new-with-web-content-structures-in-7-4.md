# 7.4でのウェブコンテンツ構造に関する新機能は？

Liferay 7.4から、Web Content Structuresはフォームを構築するバックエンドのフレームワークとして、DDM（Dynamic Data Mapping）からDE（Data Engine）に移行されました。

![Webコンテンツ構造は、Data Engineフレームワークに裏打ちされたフォームビルダーで構築されます。](./whats-new-with-web-content-structures-in-7-4/images/04.png)

データエンジンフレームワークは、Webコンテンツ構造に新たな変更と機能強化をもたらします。

## 新・改良型フィールドタイプ

Data Engineへの移行に伴い、フィールドタイプの追加と改良が行われました。

- リストから選択」フィールドのオプションをアルファベット順に並べることができます（「リストから選択」フィールドの詳細設定を使用します）。
- Numeric フィールドを整数または10進数のフィールドとして設定する。
- グリッドフィールドは、「Webコンテンツ」と「ドキュメントとメディア」の新しいフィールドタイプです。 [フォーム項目タイプのリファレンス](../../../process-automation/forms/creating-and-managing-forms/forms-field-types-reference.md)を参照してください。
- HTMLフィールドは、便利なツールバーを備えたリッチテキストフィールドに変更されました。

```{warning}
**Boolean フィールドと Multiple Selection フィールド:** Data Engine は当初 Boolean フィールドを搭載していませんでした。 代わりに、アップグレードされた構造体のブール値フィールドは、データエンジンの複数選択フィールドを使用するように移行され、同じラベルと1つのオプションだけを使用するようになりました。 例えば、Booleanフィールドを持つStructures上でテンプレートが構築された場合、いくつかの問題が発生する可能性があります。 Liferay 7.4 Update/GA 23で、Data EngineにBooleanフィールドタイプが追加されました。 Update 23以降にアップグレードされた構造体は、Webコンテンツ構造体の7.3 DDM Booleanフィールドを7.4 DE Booleanフィールドに正常に変換します。 この変更以前にインストールをアップグレードした場合は、該当する構造を編集して、これらの単一オプションのMultiple SelectionフィールドをBooleanフィールドに手動で変更する必要があります。 
```

## 子構造が構造体フィールドセットに置き換わる

DDMでバックアップされたストラクチャは、親のフィールドと設定をすべて継承した子ストラクチャを含むことができます。 Liferay 7.4では、フィールドセットを作成できるようになったので、この関係はもはや存在しません。同様に、構造体に対して再利用可能なフィールドセットを作成することができるようになりました。 フィールドセットを使用すると、構造体がどのように見えるかを確認しながら編集できるため、編集の効率が向上します。

```{warning}
- フィールドセットは、複数のStructureにまたがって再利用可能です。 1つのStructure内で編集すると、すべてのStructureに一度に変更が加えられます。

- フィールドセットや構造体がWebコンテンツで使用されている場合、編集するとユーザーへの警告が表示されます。

   ![コンテンツ参照を持つ構造体やフィールドセットの編集に注意してください。](./whats-new-with-web-content-structures-in-7-4/images/09.png)
```

フィールドセットと連動するため。

1. Web Content Structure フォームビルダービューで、 **Fieldsets** タブをクリックします。
1. **新規フィールドセットの作成** をクリックします。 フィールドセットに名前を付けます。
1. そのフィールドを追加し、設定する。 ［**保存**］ をクリックします。

![ストラクチャーまたは専用のフィールドセットをストラクチャーで使用します。](./whats-new-with-web-content-structures-in-7-4/images/07.png)

新しいストラクチャーの作成を開始すると、既存のフィールドセットやストラクチャーがフィールドセットタブで選択できるようになります。 基本的なWebコンテンツ構造は、すぐに使えるフィールドセットとして含まれています。

## 構造体定義 ソースの変更

DEでは構造体をJSONで表現しています（DDMではXMLでした）。 Web Content Structures UI でソース編集を許可する代わりに、Structure 定義をインポートおよびエクスポートして、Structure のソース JSON をローカルで操作できるようになりました。

```{warning} 
JSON Structureのソースは、一見すると複雑なので、注意して作業してください。 例えば、構造体にフィールドを追加する場合、 `dataDefinitionFields` 配列と `defaultDataLayout` 要素の両方を更新しなければなりません。 
```

StructureのJSONをエクスポートします。

1. サイトメニュー &rarr; コンテンツとデータ &rarr; Webコンテンツにアクセスします。
1. ［**ストラクチャー**］ タブをクリックします。
1. 既存の構造体がない場合は、構造体を作成し、保存します。
1. メインストラクチャのリストビューで、Actions メニューを開き、 **Export** as JSON_をクリックします。

既存のStructureにStructure JSONをインポートする（つまり、既存のStructure JSONを上書きする）。

1. サイトメニュー &rarr; コンテンツとデータ &rarr; Webコンテンツにアクセスします。
1. ［**ストラクチャー**］ タブをクリックします。
1. メインのStructuresリストビューで、StructureのActionsメニューを開き、 **Import and Override** をクリックします。
1. JSONファイルをアップロードします。

![Web Content StructureのJSONをエクスポートおよびインポートします。](./whats-new-with-web-content-structures-in-7-4/images/01.png)

新しいStructureをインポートする。

1. サイトメニュー &rarr; コンテンツとデータ &rarr; Webコンテンツにアクセスします。
1. ［**ストラクチャー**］ タブをクリックします。
1. 画面右上の「Webコンテンツ」のオプションメニューを開く。
1. **構造体のインポート** をクリックします。

   ![JSON構造体ファイルをインポートする。](./whats-new-with-web-content-structures-in-7-4/images/02.png)

## 柔軟な構造レイアウト

以前は、構造体フィールドはフォーム上で順序付けされ、ネストされてフォームの階層的なビューを作成することができました。 StructureのData Engine表現では、カラムを定義する機能が追加されています。

![1行に2列の構造体を作成します。](./whats-new-with-web-content-structures-in-7-4/images/08.png)

構造体ビルダーで2つのフォームフィールドを隣り合わせに追加し、フィールドの端をドラッグして列のサイズを変更します。

列だけでなく、フィールドグループを使って、構造体のフィールドのサブセットをロックして、簡単に管理できます。 フィールドを他のフィールドの上にドロップして、フィールドグループを作成します。
