# 標準に基づく認証アプローチ

**概要**

* Liferay 認証は、OpenID Connect、SAML などの標準ベースの認証アプローチでサポートされています。
* 外部 ID 管理システムは、シングルサインオンと組み合わせて使用されることが多く、1 つの認証ログインを複数のアプリケーションで使用できるようにする。
* 多要素認証は、基本的なパスワードベースの認証に、セキュリティを向上させるための追加要素を加えることによって拡張されます。

## OpenId Connect

LiferayのネイティブなID管理機能を使わない場合、非常に一般的なアプローチは、標準ベースの分散型認証プロトコルであるOpenID Connect（OIDC）を使用することです。

OpenID Connectは一般的にB2Cタイプのアプリケーションで使用され、ユーザーはGoogle、Facebook、Microsoft、Apple、GitHubのような有名なプロバイダから既存の認証情報を使用してLiferayに接続することができます。

プロバイダーの潜在的なリストはほとんど無限であることに注意することが重要である。 プロバイダがOpenID Connectをサポートしていれば、Liferay DXPで使用するように設定できます。

OpenID Connectは簡単な設定で利用できるため、開発作業は不要で、スケーラビリティや柔軟性といったOpenID Connectの利点を強調する。 OpenID Connectでは、ユーザが最初にOpenID Connectの認証情報を使って認証すると、Liferayは自動的にユーザアカウントを作成します。

ほとんどのデモではOpenID Connectのような認証メカニズムは通常使いません。認証の話を説明するには通常ネイティブのLiferay Authenticationで十分だからです。

確かに、この学習パスの目的である「既存のデモを使って30分のデモを行う準備をする」ためには、OpenID Connectのような機能のデモンストレーションや、ログインのカスタマイズは全く期待できません。

**もし**見込み顧客が外部IDを使ったLiferayへの認証を確認したい場合、OpenID Connectを使うようにLiferayを設定するのは簡単です。ただし、OpenID Connectの標準実装では、ユーザーがリンクをクリックし、プロバイダを手動で選択する必要があることに注意してください。

多くの実世界のユースケースにおいて、これは完全に適切である - ユーザーがプロバイダーのリストから選択する場合 - しかし、見込み客の要件が、すべてのユーザーが **シングル** プロバイダーを使用して認証することである場合、すぐに使えるUIは正しい期待を設定しないかもしれない。

Liferayのセールスエンジニアの一人が、プロセスをシームレスにするボタンを提供するシンプルなカスタムFragmentを作成しました。 このフラグメントのソースコードは、Github [](https://github.com/lgdd/openid-connect-single-button)にあります。

## SAML、SSO、IDMS

Liferayがすぐにサポートするもう一つの認証メカニズムはSAMLで、これはSecurity Assertion Markup Languageの略です。 SAML は、認証に使用されるオープン・スタンダードである。

SAMLは、2つの別個の、しかし緊密にリンクした概念を使用して動作する：

* 1 つのシステムが ID プロバイダ（IdP）として機能し、ユーザ記録と資格情報を格納する。
* 第2のシステムはサービス・プロバイダー（SP）として機能し、認証されるアプリケーションである。

Liferay の SAML 実装は、Liferay を ID プロバイダまたはサービスプロバイダとして使用でき るが、ほとんどの場合、サービスプロバイダとして使用される。

SAMLはシングルサインオンのシナリオ（SSO）で最も使われる方法で、既知のユーザーセットがあり、組織内の他のユーザーと一緒にLiferayにログインする簡単な方法が必要です。 使用例としては、イントラネットのような社内システムがある。

シングル・サインオンでは（SAML またはその他の機能を使用して実装されているかどうかに関係なく）、ユーザは 1 つのユーザ ID とパスワードを覚えておくだけでよく、1 つのシステムにログインすると、すべてのシステムで自動的に認証される。

通常、SAML を使用する場合、クレデンシャルを管理する外部システム（専用の ID 管理シス テム（IDMS））がある。 この構成では、パスワードはLiferayで管理されませんが、ユーザーアカウントは作成され、パーミッションが割り当てられます。 これは認証（Authentication）と認可（Authorization）の分離の良い例である：

* ユーザーは、ID 管理システム内の認証情報に基づいて認証される。
* ユーザーは Liferay で定義された権限によって認可されます。

鍵の例えを続けると、SAML は Liferay 認証で使用されるものとは異なるタイプの鍵である。 例えば、Liferayにログインする方法は他にもたくさんあります：

* LDAP（ライトウェイト・ディレクトリ・アクセス・プロトコル）を設定することができる。
* トークン・ベースのシステムが使用できる
* カスタム認証メカニズムを開発することもできる。

## 多要素認証

パスワード・ベースのセキュリティは、誰もが慣れ親しんでいるものだ。 パスワードの限界もよく知られている：

* 共有される
* 強力なパスワードポリシーがない限り、推測は容易である。
* 強力なパスワードを使用していても、ユーザが忘れてしまう可能性があるため、パスワードが書き留められる可能性がある。

多要素認証（MFA）は、回避が不可能ではないにせよ、より困難な認証要素を追加する。 ほとんどの人は、電子メールやSMSでコードを送信する、時間ベースのワンタイムピンのような技術に精通している。 これらは短期間で失効するため、簡単に共有することはできない。

さらに安全なのは、Fast Identity Online 2（FIDO2）デバイスやアプリケーション（Google Authenticatorなど）を使用することで、PINを特定のデバイスに結びつけることができる。

Liferayは多要素認証のサポートをすぐに提供し、以下の要素をサポートします：

* ワンタイムピン（OTP）
* タイムベースOTP（TOTP）
* 電子メールによるワンタイムパスワード
* FIDO2デバイスとアプリケーション。
* IPアドレス範囲制限

この最後のオプションは、実際には多要素認証ではありません - 認証を試みることができる人を制限しています - 実際、同様の機能は、Webアプリケーションファイアウォールを介して実装することができ、またはLiferayの前にWeb階層を使用することができます - しかし、それは製品で利用できるようにするために便利です - そしてデモを行うときに話をする。

ほとんどのデモでは、多要素認証のライブデモは含まれませんが、そうすることで、Liferayアプリケーションは安全であるという見込み客に高い信頼性を築くことができるため、すぐに提供される機能について話すことは重要です。

最後にこのモジュールでは、認証が [認可](./authorization.md) でどのように補完されるかについて学び、認証されたユーザが何を見たり対話したりできるかを制御する。
